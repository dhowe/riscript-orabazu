"use strict";Object.defineProperty(exports, "__esModule", {value: true}); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } function _nullishCoalesce(lhs, rhsFn) { if (lhs != null) { return lhs; } else { return rhsFn(); } } function _optionalChain(ops) { let lastAccessLHS = undefined; let value = ops[0]; let i = 1; while (i < ops.length) { const op = ops[i]; const fn = ops[i + 1]; i += 2; if ((op === 'optionalAccess' || op === 'optionalCall') && value == null) { return undefined; } if (op === 'access' || op === 'optionalAccess') { lastAccessLHS = value; value = fn(value); } else if (op === 'call' || op === 'optionalCall') { value = fn((...args) => value.call(lastAccessLHS, ...args)); lastAccessLHS = undefined; } } return value; }var uc=Object.defineProperty;var pc=(e,t,r)=>t in e?uc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var qr=(e,t,r)=>(pc(e,typeof t!="symbol"?t+"":t,r),r);var _he = require('he'); var _he2 = _interopRequireDefault(_he);var _mingo = require('mingo');var hc=typeof global=="object"&&global&&global.Object===Object&&global,Jr=hc;var dc=typeof self=="object"&&self&&self.Object===Object&&self,mc=Jr||dc||Function("return this")(),J=mc;var gc=J.Symbol,ot=gc;var so=Object.prototype,xc=so.hasOwnProperty,Ec=so.toString,yr=ot?ot.toStringTag:void 0;function Tc(e){var t=xc.call(e,yr),r=e[yr];try{e[yr]=void 0;var n=!0}catch (e2){}var i=Ec.call(e);return n&&(t?e[yr]=r:delete e[yr]),i}var ao=Tc;var Ac=Object.prototype,Ic=Ac.toString;function yc(e){return Ic.call(e)}var lo=yc;var Rc="[object Null]",Sc="[object Undefined]",co=ot?ot.toStringTag:void 0;function Oc(e){return e==null?e===void 0?Sc:Rc:co&&co in Object(e)?ao(e):lo(e)}var ht=Oc;function Nc(e){return e!=null&&typeof e=="object"}var z=Nc;var _c="[object Symbol]";function Cc(e){return typeof e=="symbol"||z(e)&&ht(e)==_c}var oe=Cc;function vc(e,t){for(var r=-1,n=e==null?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i}var wt=vc;var bc=Array.isArray,A=bc;var Lc=1/0,fo=ot?ot.prototype:void 0,uo=fo?fo.toString:void 0;function po(e){if(typeof e=="string")return e;if(A(e))return wt(e,po)+"";if(oe(e))return uo?uo.call(e):"";var t=e+"";return t=="0"&&1/e==-Lc?"-0":t}var ho=po;var Pc=/\s/;function kc(e){for(var t=e.length;t--&&Pc.test(e.charAt(t)););return t}var mo=kc;var Mc=/^\s+/;function wc(e){return e&&e.slice(0,mo(e)+1).replace(Mc,"")}var go=wc;function Fc(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var B=Fc;var xo=0/0,Uc=/^[-+]0x[0-9a-f]+$/i,Dc=/^0b[01]+$/i,Gc=/^0o[0-7]+$/i,$c=parseInt;function Bc(e){if(typeof e=="number")return e;if(oe(e))return xo;if(B(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=B(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=go(e);var r=Dc.test(e);return r||Gc.test(e)?$c(e.slice(2),r?2:8):Uc.test(e)?xo:+e}var Eo=Bc;var To=1/0,Wc=17976931348623157e292;function jc(e){if(!e)return e===0?e:0;if(e=Eo(e),e===To||e===-To){var t=e<0?-1:1;return t*Wc}return e===e?e:0}var Ao=jc;function Kc(e){var t=Ao(e),r=t%1;return t===t?r?t-r:t:0}var Ft=Kc;function Hc(e){return e}var _t=Hc;var zc="[object AsyncFunction]",Vc="[object Function]",Yc="[object GeneratorFunction]",Xc="[object Proxy]";function qc(e){if(!B(e))return!1;var t=ht(e);return t==Vc||t==Yc||t==zc||t==Xc}var dt=qc;var Jc=J["__core-js_shared__"],Zr=Jc;var Io=function(){var e=/[^.]+$/.exec(Zr&&Zr.keys&&Zr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Zc(e){return!!Io&&Io in e}var yo=Zc;var Qc=Function.prototype,tf=Qc.toString;function ef(e){if(e!=null){try{return tf.call(e)}catch (e3){}try{return e+""}catch (e4){}}return""}var Xt=ef;var rf=/[\\^$.*+?()[\]{}|]/g,nf=/^\[object .+?Constructor\]$/,of=Function.prototype,sf=Object.prototype,af=of.toString,lf=sf.hasOwnProperty,cf=RegExp("^"+af.call(lf).replace(rf,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ff(e){if(!B(e)||yo(e))return!1;var t=dt(e)?cf:nf;return t.test(Xt(e))}var Ro=ff;function uf(e,t){return _optionalChain([e, 'optionalAccess', _2 => _2[t]])}var So=uf;function pf(e,t){var r=So(e,t);return Ro(r)?r:void 0}var At=pf;var hf=At(J,"WeakMap"),Qr=hf;var Oo=Object.create,df=function(){function e(){}return function(t){if(!B(t))return{};if(Oo)return Oo(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),No=df;function mf(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var _o=mf;function gf(){}var W=gf;function xf(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var Co=xf;var Ef=800,Tf=16,Af=Date.now;function If(e){var t=0,r=0;return function(){var n=Af(),i=Tf-(n-r);if(r=n,i>0){if(++t>=Ef)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var vo=If;function yf(e){return function(){return e}}var bo=yf;var Rf=function(){try{var e=At(Object,"defineProperty");return e({},"",{}),e}catch (e5){}}(),Fe=Rf;var Sf=Fe?function(e,t){return Fe(e,"toString",{configurable:!0,enumerable:!1,value:bo(t),writable:!0})}:_t,Lo=Sf;var Of=vo(Lo),Po=Of;function Nf(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var tn=Nf;function _f(e,t,r,n){for(var i=e.length,o=r+(n?1:-1);n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}var en=_f;function Cf(e){return e!==e}var ko=Cf;function vf(e,t,r){for(var n=r-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}var Mo=vf;function bf(e,t,r){return t===t?Mo(e,t,r):en(e,ko,r)}var Ue=bf;function Lf(e,t){var r=e==null?0:e.length;return!!r&&Ue(e,t,0)>-1}var rn=Lf;var Pf=9007199254740991,kf=/^(?:0|[1-9]\d*)$/;function Mf(e,t){var r=typeof e;return t=_nullishCoalesce(t, () => (Pf)),!!t&&(r=="number"||r!="symbol"&&kf.test(e))&&e>-1&&e%1==0&&e<t}var se=Mf;function wf(e,t,r){t=="__proto__"&&Fe?Fe(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var De=wf;function Ff(e,t){return e===t||e!==e&&t!==t}var Ut=Ff;var Uf=Object.prototype,Df=Uf.hasOwnProperty;function Gf(e,t,r){var n=e[t];(!(Df.call(e,t)&&Ut(n,r))||r===void 0&&!(t in e))&&De(e,t,r)}var ae=Gf;function $f(e,t,r,n){var i=!r;r||(r={});for(var o=-1,s=t.length;++o<s;){var a=t[o],l=n?n(r[a],e[a],a,r,e):void 0;l===void 0&&(l=e[a]),i?De(r,a,l):ae(r,a,l)}return r}var Dt=$f;var wo=Math.max;function Bf(e,t,r){return t=wo(t===void 0?e.length-1:t,0),function(){for(var n=arguments,i=-1,o=wo(n.length-t,0),s=Array(o);++i<o;)s[i]=n[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=n[i];return a[t]=r(s),_o(e,this,a)}}var Fo=Bf;function Wf(e,t){return Po(Fo(e,t,_t),e+"")}var Ge=Wf;var jf=9007199254740991;function Kf(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=jf}var $e=Kf;function Hf(e){return e!=null&&$e(e.length)&&!dt(e)}var Z=Hf;function zf(e,t,r){if(!B(r))return!1;var n=typeof t;return(n=="number"?Z(r)&&se(t,r.length):n=="string"&&t in r)?Ut(r[t],e):!1}var le=zf;function Vf(e){return Ge(function(t,r){var n=-1,i=r.length,o=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(o=e.length>3&&typeof o=="function"?(i--,o):void 0,s&&le(r[0],r[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++n<i;){var a=r[n];a&&e(t,a,n,o)}return t})}var Uo=Vf;var Yf=Object.prototype;function Xf(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Yf;return e===r}var Gt=Xf;function qf(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var Do=qf;var Jf="[object Arguments]";function Zf(e){return z(e)&&ht(e)==Jf}var di=Zf;var Go=Object.prototype,Qf=Go.hasOwnProperty,tu=Go.propertyIsEnumerable,eu=di(function(){return arguments}())?di:function(e){return z(e)&&Qf.call(e,"callee")&&!tu.call(e,"callee")},ce=eu;function ru(){return!1}var $o=ru;var jo=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Bo=jo&&typeof module=="object"&&module&&!module.nodeType&&module,nu=Bo&&Bo.exports===jo,Wo=nu?J.Buffer:void 0,iu=Wo?Wo.isBuffer:void 0,ou=iu||$o,qt=ou;var su="[object Arguments]",au="[object Array]",lu="[object Boolean]",cu="[object Date]",fu="[object Error]",uu="[object Function]",pu="[object Map]",hu="[object Number]",du="[object Object]",mu="[object RegExp]",gu="[object Set]",xu="[object String]",Eu="[object WeakMap]",Tu="[object ArrayBuffer]",Au="[object DataView]",Iu="[object Float32Array]",yu="[object Float64Array]",Ru="[object Int8Array]",Su="[object Int16Array]",Ou="[object Int32Array]",Nu="[object Uint8Array]",_u="[object Uint8ClampedArray]",Cu="[object Uint16Array]",vu="[object Uint32Array]",U={};U[Iu]=U[yu]=U[Ru]=U[Su]=U[Ou]=U[Nu]=U[_u]=U[Cu]=U[vu]=!0;U[su]=U[au]=U[Tu]=U[lu]=U[Au]=U[cu]=U[fu]=U[uu]=U[pu]=U[hu]=U[du]=U[mu]=U[gu]=U[xu]=U[Eu]=!1;function bu(e){return z(e)&&$e(e.length)&&!!U[ht(e)]}var Ko=bu;function Lu(e){return function(t){return e(t)}}var $t=Lu;var Ho=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Rr=Ho&&typeof module=="object"&&module&&!module.nodeType&&module,Pu=Rr&&Rr.exports===Ho,mi=Pu&&Jr.process,ku=function(){try{var e=Rr&&Rr.require&&Rr.require("util").types;return e||mi&&mi.binding&&mi.binding("util")}catch (e6){}}(),Ct=ku;var zo=Ct&&Ct.isTypedArray,Mu=zo?$t(zo):Ko,Be=Mu;var wu=Object.prototype,Fu=wu.hasOwnProperty;function Uu(e,t){var r=A(e),n=!r&&ce(e),i=!r&&!n&&qt(e),o=!r&&!n&&!i&&Be(e),s=r||n||i||o,a=s?Do(e.length,String):[],l=a.length;for(var c in e)(t||Fu.call(e,c))&&!(s&&(c=="length"||i&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||se(c,l)))&&a.push(c);return a}var nn=Uu;function Du(e,t){return function(r){return e(t(r))}}var on=Du;var Gu=on(Object.keys,Object),Vo=Gu;var $u=Object.prototype,Bu=$u.hasOwnProperty;function Wu(e){if(!Gt(e))return Vo(e);var t=[];for(var r in Object(e))Bu.call(e,r)&&r!="constructor"&&t.push(r);return t}var sn=Wu;function ju(e){return Z(e)?nn(e):sn(e)}var P=ju;var Ku=Object.prototype,Hu=Ku.hasOwnProperty,zu=Uo(function(e,t){if(Gt(t)||Z(t)){Dt(t,P(t),e);return}for(var r in t)Hu.call(t,r)&&ae(e,r,t[r])}),at=zu;function Vu(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var Yo=Vu;var Yu=Object.prototype,Xu=Yu.hasOwnProperty;function qu(e){if(!B(e))return Yo(e);var t=Gt(e),r=[];for(var n in e)n=="constructor"&&(t||!Xu.call(e,n))||r.push(n);return r}var Xo=qu;function Ju(e){return Z(e)?nn(e,!0):Xo(e)}var fe=Ju;var Zu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Qu=/^\w*$/;function tp(e,t){if(A(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||oe(e)?!0:Qu.test(e)||!Zu.test(e)||t!=null&&e in Object(t)}var We=tp;var ep=At(Object,"create"),Jt=ep;function rp(){this.__data__=Jt?Jt(null):{},this.size=0}var qo=rp;function np(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Jo=np;var ip="__lodash_hash_undefined__",op=Object.prototype,sp=op.hasOwnProperty;function ap(e){var t=this.__data__;if(Jt){var r=t[e];return r===ip?void 0:r}return sp.call(t,e)?t[e]:void 0}var Zo=ap;var lp=Object.prototype,cp=lp.hasOwnProperty;function fp(e){var t=this.__data__;return Jt?t[e]!==void 0:cp.call(t,e)}var Qo=fp;var up="__lodash_hash_undefined__";function pp(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Jt&&t===void 0?up:t,this}var ts=pp;function je(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}je.prototype.clear=qo;je.prototype.delete=Jo;je.prototype.get=Zo;je.prototype.has=Qo;je.prototype.set=ts;var gi=je;function hp(){this.__data__=[],this.size=0}var es=hp;function dp(e,t){for(var r=e.length;r--;)if(Ut(e[r][0],t))return r;return-1}var ue=dp;var mp=Array.prototype,gp=mp.splice;function xp(e){var t=this.__data__,r=ue(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():gp.call(t,r,1),--this.size,!0}var rs=xp;function Ep(e){var t=this.__data__,r=ue(t,e);return r<0?void 0:t[r][1]}var ns=Ep;function Tp(e){return ue(this.__data__,e)>-1}var is=Tp;function Ap(e,t){var r=this.__data__,n=ue(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var os=Ap;function Ke(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ke.prototype.clear=es;Ke.prototype.delete=rs;Ke.prototype.get=ns;Ke.prototype.has=is;Ke.prototype.set=os;var pe=Ke;var Ip=At(J,"Map"),he=Ip;function yp(){this.size=0,this.__data__={hash:new gi,map:new(he||pe),string:new gi}}var ss=yp;function Rp(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var as=Rp;function Sp(e,t){var r=e.__data__;return as(t)?r[typeof t=="string"?"string":"hash"]:r.map}var de=Sp;function Op(e){var t=de(this,e).delete(e);return this.size-=t?1:0,t}var ls=Op;function Np(e){return de(this,e).get(e)}var cs=Np;function _p(e){return de(this,e).has(e)}var fs=_p;function Cp(e,t){var r=de(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var us=Cp;function He(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}He.prototype.clear=ss;He.prototype.delete=ls;He.prototype.get=cs;He.prototype.has=fs;He.prototype.set=us;var Se=He;var vp="Expected a function";function xi(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(vp);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=e.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(xi.Cache||Se),r}xi.Cache=Se;var ps=xi;var bp=500;function Lp(e){var t=ps(e,function(n){return r.size===bp&&r.clear(),n}),r=t.cache;return t}var hs=Lp;var Pp=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kp=/\\(\\)?/g,Mp=hs(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Pp,function(r,n,i,o){t.push(i?o.replace(kp,"$1"):n||r)}),t}),ds=Mp;function wp(e){return e==null?"":ho(e)}var ms=wp;function Fp(e,t){return A(e)?e:We(e,t)?[e]:ds(ms(e))}var me=Fp;var Up=1/0;function Dp(e){if(typeof e=="string"||oe(e))return e;var t=e+"";return t=="0"&&1/e==-Up?"-0":t}var Bt=Dp;function Gp(e,t){t=me(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[Bt(t[r++])];return r&&r==n?e:void 0}var ze=Gp;function $p(e,t,r){var n=e==null?void 0:ze(e,t);return n===void 0?r:n}var gs=$p;function Bp(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}var Ve=Bp;var xs=ot?ot.isConcatSpreadable:void 0;function Wp(e){return A(e)||ce(e)||!!(xs&&e&&e[xs])}var Es=Wp;function Ts(e,t,r,n,i){var o=-1,s=e.length;for(r||(r=Es),i||(i=[]);++o<s;){var a=e[o];t>0&&r(a)?t>1?Ts(a,t-1,r,n,i):Ve(i,a):n||(i[i.length]=a)}return i}var Ye=Ts;function jp(e){var t=e==null?0:e.length;return t?Ye(e,1):[]}var rt=jp;var Kp=on(Object.getPrototypeOf,Object),an=Kp;function Hp(e,t,r){var n=-1,i=e.length;t<0&&(t=-t>i?0:i+t),r=r>i?i:r,r<0&&(r+=i),i=t>r?0:r-t>>>0,t>>>=0;for(var o=Array(i);++n<i;)o[n]=e[n+t];return o}var ln=Hp;function zp(e,t,r,n){var i=-1,o=e==null?0:e.length;for(n&&o&&(r=e[++i]);++i<o;)r=t(r,e[i],i,e);return r}var As=zp;function Vp(){this.__data__=new pe,this.size=0}var Is=Vp;function Yp(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var ys=Yp;function Xp(e){return this.__data__.get(e)}var Rs=Xp;function qp(e){return this.__data__.has(e)}var Ss=qp;var Jp=200;function Zp(e,t){var r=this.__data__;if(r instanceof pe){var n=r.__data__;if(!he||n.length<Jp-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Se(n)}return r.set(e,t),this.size=r.size,this}var Os=Zp;function Xe(e){var t=this.__data__=new pe(e);this.size=t.size}Xe.prototype.clear=Is;Xe.prototype.delete=ys;Xe.prototype.get=Rs;Xe.prototype.has=Ss;Xe.prototype.set=Os;var ge=Xe;function Qp(e,t){return e&&Dt(t,P(t),e)}var Ns=Qp;function th(e,t){return e&&Dt(t,fe(t),e)}var _s=th;var Ls=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Cs=Ls&&typeof module=="object"&&module&&!module.nodeType&&module,eh=Cs&&Cs.exports===Ls,vs=eh?J.Buffer:void 0,bs=vs?vs.allocUnsafe:void 0;function rh(e,t){if(t)return e.slice();var r=e.length,n=bs?bs(r):new e.constructor(r);return e.copy(n),n}var Ps=rh;function nh(e,t){for(var r=-1,n=e==null?0:e.length,i=0,o=[];++r<n;){var s=e[r];t(s,r,e)&&(o[i++]=s)}return o}var qe=nh;function ih(){return[]}var cn=ih;var oh=Object.prototype,sh=oh.propertyIsEnumerable,ks=Object.getOwnPropertySymbols,ah=ks?function(e){return e==null?[]:(e=Object(e),qe(ks(e),function(t){return sh.call(e,t)}))}:cn,Je=ah;function lh(e,t){return Dt(e,Je(e),t)}var Ms=lh;var ch=Object.getOwnPropertySymbols,fh=ch?function(e){for(var t=[];e;)Ve(t,Je(e)),e=an(e);return t}:cn,fn=fh;function uh(e,t){return Dt(e,fn(e),t)}var ws=uh;function ph(e,t,r){var n=t(e);return A(e)?n:Ve(n,r(e))}var un=ph;function hh(e){return un(e,P,Je)}var Sr=hh;function dh(e){return un(e,fe,fn)}var pn=dh;var mh=At(J,"DataView"),hn=mh;var gh=At(J,"Promise"),dn=gh;var xh=At(J,"Set"),xe=xh;var Fs="[object Map]",Eh="[object Object]",Us="[object Promise]",Ds="[object Set]",Gs="[object WeakMap]",$s="[object DataView]",Th=Xt(hn),Ah=Xt(he),Ih=Xt(dn),yh=Xt(xe),Rh=Xt(Qr),Oe=ht;(hn&&Oe(new hn(new ArrayBuffer(1)))!=$s||he&&Oe(new he)!=Fs||dn&&Oe(dn.resolve())!=Us||xe&&Oe(new xe)!=Ds||Qr&&Oe(new Qr)!=Gs)&&(Oe=function(e){var t=ht(e),r=t==Eh?e.constructor:void 0,n=r?Xt(r):"";if(n)switch(n){case Th:return $s;case Ah:return Fs;case Ih:return Us;case yh:return Ds;case Rh:return Gs}return t});var Pt=Oe;var Sh=Object.prototype,Oh=Sh.hasOwnProperty;function Nh(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Oh.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var Bs=Nh;var _h=J.Uint8Array,Ze=_h;function Ch(e){var t=new e.constructor(e.byteLength);return new Ze(t).set(new Ze(e)),t}var Qe=Ch;function vh(e,t){var r=t?Qe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var Ws=vh;var bh=/\w*$/;function Lh(e){var t=new e.constructor(e.source,bh.exec(e));return t.lastIndex=e.lastIndex,t}var js=Lh;var Ks=ot?ot.prototype:void 0,Hs=Ks?Ks.valueOf:void 0;function Ph(e){return Hs?Object(Hs.call(e)):{}}var zs=Ph;function kh(e,t){var r=t?Qe(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Vs=kh;var Mh="[object Boolean]",wh="[object Date]",Fh="[object Map]",Uh="[object Number]",Dh="[object RegExp]",Gh="[object Set]",$h="[object String]",Bh="[object Symbol]",Wh="[object ArrayBuffer]",jh="[object DataView]",Kh="[object Float32Array]",Hh="[object Float64Array]",zh="[object Int8Array]",Vh="[object Int16Array]",Yh="[object Int32Array]",Xh="[object Uint8Array]",qh="[object Uint8ClampedArray]",Jh="[object Uint16Array]",Zh="[object Uint32Array]";function Qh(e,t,r){var n=e.constructor;switch(t){case Wh:return Qe(e);case Mh:case wh:return new n(+e);case jh:return Ws(e,r);case Kh:case Hh:case zh:case Vh:case Yh:case Xh:case qh:case Jh:case Zh:return Vs(e,r);case Fh:return new n;case Uh:case $h:return new n(e);case Dh:return js(e);case Gh:return new n;case Bh:return zs(e)}}var Ys=Qh;function td(e){return typeof e.constructor=="function"&&!Gt(e)?No(an(e)):{}}var Xs=td;var ed="[object Map]";function rd(e){return z(e)&&Pt(e)==ed}var qs=rd;var Js=Ct&&Ct.isMap,nd=Js?$t(Js):qs,Zs=nd;var id="[object Set]";function od(e){return z(e)&&Pt(e)==id}var Qs=od;var ta=Ct&&Ct.isSet,sd=ta?$t(ta):Qs,ea=sd;var ad=1,ld=2,cd=4,ra="[object Arguments]",fd="[object Array]",ud="[object Boolean]",pd="[object Date]",hd="[object Error]",na="[object Function]",dd="[object GeneratorFunction]",md="[object Map]",gd="[object Number]",ia="[object Object]",xd="[object RegExp]",Ed="[object Set]",Td="[object String]",Ad="[object Symbol]",Id="[object WeakMap]",yd="[object ArrayBuffer]",Rd="[object DataView]",Sd="[object Float32Array]",Od="[object Float64Array]",Nd="[object Int8Array]",_d="[object Int16Array]",Cd="[object Int32Array]",vd="[object Uint8Array]",bd="[object Uint8ClampedArray]",Ld="[object Uint16Array]",Pd="[object Uint32Array]",k={};k[ra]=k[fd]=k[yd]=k[Rd]=k[ud]=k[pd]=k[Sd]=k[Od]=k[Nd]=k[_d]=k[Cd]=k[md]=k[gd]=k[ia]=k[xd]=k[Ed]=k[Td]=k[Ad]=k[vd]=k[bd]=k[Ld]=k[Pd]=!0;k[hd]=k[na]=k[Id]=!1;function mn(e,t,r,n,i,o){var s,a=t&ad,l=t&ld,c=t&cd;if(r&&(s=i?r(e,n,i,o):r(e)),s!==void 0)return s;if(!B(e))return e;var f=A(e);if(f){if(s=Bs(e),!a)return Co(e,s)}else{var u=Pt(e),p=u==na||u==dd;if(qt(e))return Ps(e,a);if(u==ia||u==ra||p&&!i){if(s=l||p?{}:Xs(e),!a)return l?ws(e,_s(s,e)):Ms(e,Ns(s,e))}else{if(!k[u])return i?e:{};s=Ys(e,u,a)}}o||(o=new ge);var d=o.get(e);if(d)return d;o.set(e,s),ea(e)?e.forEach(function(S){s.add(mn(S,t,r,S,e,o))}):Zs(e)&&e.forEach(function(S,E){s.set(E,mn(S,t,r,E,e,o))});var I=c?l?pn:Sr:l?fe:P,y=f?void 0:I(e);return tn(y||e,function(S,E){y&&(E=S,S=e[E]),ae(s,E,mn(S,t,r,E,e,o))}),s}var oa=mn;var kd=4;function Md(e){return oa(e,kd)}var M=Md;function wd(e){for(var t=-1,r=e==null?0:e.length,n=0,i=[];++t<r;){var o=e[t];o&&(i[n++]=o)}return i}var Wt=wd;var Fd="__lodash_hash_undefined__";function Ud(e){return this.__data__.set(e,Fd),this}var sa=Ud;function Dd(e){return this.__data__.has(e)}var aa=Dd;function gn(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new Se;++t<r;)this.add(e[t])}gn.prototype.add=gn.prototype.push=sa;gn.prototype.has=aa;var tr=gn;function Gd(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var xn=Gd;function $d(e,t){return e.has(t)}var er=$d;var Bd=1,Wd=2;function jd(e,t,r,n,i,o){var s=r&Bd,a=e.length,l=t.length;if(a!=l&&!(s&&l>a))return!1;var c=o.get(e),f=o.get(t);if(c&&f)return c==t&&f==e;var u=-1,p=!0,d=r&Wd?new tr:void 0;for(o.set(e,t),o.set(t,e);++u<a;){var I=e[u],y=t[u];if(n)var S=s?n(y,I,u,t,e,o):n(I,y,u,e,t,o);if(S!==void 0){if(S)continue;p=!1;break}if(d){if(!xn(t,function(E,m){if(!er(d,m)&&(I===E||i(I,E,r,n,o)))return d.push(m)})){p=!1;break}}else if(!(I===y||i(I,y,r,n,o))){p=!1;break}}return o.delete(e),o.delete(t),p}var En=jd;function Kd(e){var t=-1,r=Array(e.size);return e.forEach(function(n,i){r[++t]=[i,n]}),r}var la=Kd;function Hd(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var rr=Hd;var zd=1,Vd=2,Yd="[object Boolean]",Xd="[object Date]",qd="[object Error]",Jd="[object Map]",Zd="[object Number]",Qd="[object RegExp]",tm="[object Set]",em="[object String]",rm="[object Symbol]",nm="[object ArrayBuffer]",im="[object DataView]",ca=ot?ot.prototype:void 0,Ei=ca?ca.valueOf:void 0;function om(e,t,r,n,i,o,s){switch(r){case im:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case nm:return!(e.byteLength!=t.byteLength||!o(new Ze(e),new Ze(t)));case Yd:case Xd:case Zd:return Ut(+e,+t);case qd:return e.name==t.name&&e.message==t.message;case Qd:case em:return e==t+"";case Jd:var a=la;case tm:var l=n&zd;if(a||(a=rr),e.size!=t.size&&!l)return!1;var c=s.get(e);if(c)return c==t;n|=Vd,s.set(e,t);var f=En(a(e),a(t),n,i,o,s);return s.delete(e),f;case rm:if(Ei)return Ei.call(e)==Ei.call(t)}return!1}var fa=om;var sm=1,am=Object.prototype,lm=am.hasOwnProperty;function cm(e,t,r,n,i,o){var s=r&sm,a=Sr(e),l=a.length,c=Sr(t),f=c.length;if(l!=f&&!s)return!1;for(var u=l;u--;){var p=a[u];if(!(s?p in t:lm.call(t,p)))return!1}var d=o.get(e),I=o.get(t);if(d&&I)return d==t&&I==e;var y=!0;o.set(e,t),o.set(t,e);for(var S=s;++u<l;){p=a[u];var E=e[p],m=t[p];if(n)var h=s?n(m,E,p,t,e,o):n(E,m,p,e,t,o);if(!(h===void 0?E===m||i(E,m,r,n,o):h)){y=!1;break}S||(S=p=="constructor")}if(y&&!S){var O=e.constructor,N=t.constructor;O!=N&&"constructor"in e&&"constructor"in t&&!(typeof O=="function"&&O instanceof O&&typeof N=="function"&&N instanceof N)&&(y=!1)}return o.delete(e),o.delete(t),y}var ua=cm;var fm=1,pa="[object Arguments]",ha="[object Array]",Tn="[object Object]",um=Object.prototype,da=um.hasOwnProperty;function pm(e,t,r,n,i,o){var s=A(e),a=A(t),l=s?ha:Pt(e),c=a?ha:Pt(t);l=l==pa?Tn:l,c=c==pa?Tn:c;var f=l==Tn,u=c==Tn,p=l==c;if(p&&qt(e)){if(!qt(t))return!1;s=!0,f=!1}if(p&&!f)return o||(o=new ge),s||Be(e)?En(e,t,r,n,i,o):fa(e,t,l,r,n,i,o);if(!(r&fm)){var d=f&&da.call(e,"__wrapped__"),I=u&&da.call(t,"__wrapped__");if(d||I){var y=d?e.value():e,S=I?t.value():t;return o||(o=new ge),i(y,S,r,n,o)}}return p?(o||(o=new ge),ua(e,t,r,n,i,o)):!1}var ma=pm;function ga(e,t,r,n,i){return e===t?!0:e==null||t==null||!z(e)&&!z(t)?e!==e&&t!==t:ma(e,t,r,n,ga,i)}var An=ga;var hm=1,dm=2;function mm(e,t,r,n){var i=r.length,o=i,s=!n;if(e==null)return!o;for(e=Object(e);i--;){var a=r[i];if(s&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){a=r[i];var l=a[0],c=e[l],f=a[1];if(s&&a[2]){if(c===void 0&&!(l in e))return!1}else{var u=new ge;if(n)var p=n(c,f,l,e,t,u);if(!(p===void 0?An(f,c,hm|dm,n,u):p))return!1}}return!0}var xa=mm;function gm(e){return e===e&&!B(e)}var In=gm;function xm(e){for(var t=P(e),r=t.length;r--;){var n=t[r],i=e[n];t[r]=[n,i,In(i)]}return t}var Ea=xm;function Em(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var yn=Em;function Tm(e){var t=Ea(e);return t.length==1&&t[0][2]?yn(t[0][0],t[0][1]):function(r){return r===e||xa(r,e,t)}}var Ta=Tm;function Am(e,t){return e!=null&&t in Object(e)}var Aa=Am;function Im(e,t,r){t=me(t,e);for(var n=-1,i=t.length,o=!1;++n<i;){var s=Bt(t[n]);if(!(o=e!=null&&r(e,s)))break;e=e[s]}return o||++n!=i?o:(i=e==null?0:e.length,!!i&&$e(i)&&se(s,i)&&(A(e)||ce(e)))}var Rn=Im;function ym(e,t){return e!=null&&Rn(e,t,Aa)}var Ia=ym;var Rm=1,Sm=2;function Om(e,t){return We(e)&&In(t)?yn(Bt(e),t):function(r){var n=gs(r,e);return n===void 0&&n===t?Ia(r,e):An(t,n,Rm|Sm)}}var ya=Om;function Nm(e){return function(t){return _optionalChain([t, 'optionalAccess', _3 => _3[e]])}}var Ra=Nm;function _m(e){return function(t){return ze(t,e)}}var Sa=_m;function Cm(e){return We(e)?Ra(Bt(e)):Sa(e)}var Oa=Cm;function vm(e){return typeof e=="function"?e:e==null?_t:typeof e=="object"?A(e)?ya(e[0],e[1]):Ta(e):Oa(e)}var Q=vm;function bm(e,t,r,n){for(var i=-1,o=e==null?0:e.length;++i<o;){var s=e[i];t(n,s,r(s),e)}return n}var Na=bm;function Lm(e){return function(t,r,n){for(var i=-1,o=Object(t),s=n(t),a=s.length;a--;){var l=s[e?a:++i];if(r(o[l],l,o)===!1)break}return t}}var _a=Lm;var Pm=_a(),Ca=Pm;function km(e,t){return e&&Ca(e,t,P)}var va=km;function Mm(e,t){return function(r,n){if(r==null)return r;if(!Z(r))return e(r,n);for(var i=r.length,o=t?i:-1,s=Object(r);(t?o--:++o<i)&&n(s[o],o,s)!==!1;);return r}}var ba=Mm;var wm=ba(va),It=wm;function Fm(e,t,r,n){return It(e,function(i,o,s){t(n,i,r(i),s)}),n}var La=Fm;function Um(e,t){return function(r,n){var i=A(r)?Na:La,o=t?t():{};return i(r,e,Q(n,2),o)}}var Pa=Um;var ka=Object.prototype,Dm=ka.hasOwnProperty,Gm=Ge(function(e,t){e=Object(e);var r=-1,n=t.length,i=n>2?t[2]:void 0;for(i&&le(t[0],t[1],i)&&(n=1);++r<n;)for(var o=t[r],s=fe(o),a=-1,l=s.length;++a<l;){var c=s[a],f=e[c];(f===void 0||Ut(f,ka[c])&&!Dm.call(e,c))&&(e[c]=o[c])}return e}),nr=Gm;function $m(e){return z(e)&&Z(e)}var Ti=$m;function Bm(e,t,r){for(var n=-1,i=e==null?0:e.length;++n<i;)if(r(t,e[n]))return!0;return!1}var Sn=Bm;var Wm=200;function jm(e,t,r,n){var i=-1,o=rn,s=!0,a=e.length,l=[],c=t.length;if(!a)return l;r&&(t=wt(t,$t(r))),n?(o=Sn,s=!1):t.length>=Wm&&(o=er,s=!1,t=new tr(t));t:for(;++i<a;){var f=e[i],u=r==null?f:r(f);if(f=n||f!==0?f:0,s&&u===u){for(var p=c;p--;)if(t[p]===u)continue t;l.push(f)}else o(t,u,n)||l.push(f)}return l}var Ma=jm;var Km=Ge(function(e,t){return Ti(e)?Ma(e,Ye(t,1,Ti,!0)):[]}),Ee=Km;function Hm(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var jt=Hm;function zm(e,t,r){var n=e==null?0:e.length;return n?(t=r||t===void 0?1:Ft(t),ln(e,t<0?0:t,n)):[]}var V=zm;function Vm(e,t,r){var n=e==null?0:e.length;return n?(t=r||t===void 0?1:Ft(t),t=n-t,ln(e,0,t<0?0:t)):[]}var Zt=Vm;function Ym(e){return typeof e=="function"?e:_t}var wa=Ym;function Xm(e,t){var r=A(e)?tn:It;return r(e,wa(t))}var x=Xm;function qm(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(!t(e[r],r,e))return!1;return!0}var Fa=qm;function Jm(e,t){var r=!0;return It(e,function(n,i,o){return r=!!t(n,i,o),r}),r}var Ua=Jm;function Zm(e,t,r){var n=A(e)?Fa:Ua;return r&&le(e,t,r)&&(t=void 0),n(e,Q(t,3))}var ct=Zm;function Qm(e,t){var r=[];return It(e,function(n,i,o){t(n,i,o)&&r.push(n)}),r}var On=Qm;function tg(e,t){var r=A(e)?qe:On;return r(e,Q(t,3))}var ft=tg;function eg(e){return function(t,r,n){var i=Object(t);if(!Z(t)){var o=Q(r,3);t=P(t),r=function(a){return o(i[a],a,i)}}var s=e(t,r,n);return s>-1?i[o?t[s]:s]:void 0}}var Da=eg;var rg=Math.max;function ng(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=r==null?0:Ft(r);return i<0&&(i=rg(n+i,0)),en(e,Q(t,3),i)}var Ga=ng;var ig=Da(Ga),Kt=ig;function og(e){return e&&e.length?e[0]:void 0}var st=og;function sg(e,t){var r=-1,n=Z(e)?Array(e.length):[];return It(e,function(i,o,s){n[++r]=t(i,o,s)}),n}var $a=sg;function ag(e,t){var r=A(e)?wt:$a;return r(e,Q(t,3))}var g=ag;function lg(e,t){return Ye(g(e,t),1)}var mt=lg;var cg=Object.prototype,fg=cg.hasOwnProperty,ug=Pa(function(e,t,r){fg.call(e,r)?e[r].push(t):De(e,r,[t])}),Ai=ug;var pg=Object.prototype,hg=pg.hasOwnProperty;function dg(e,t){return e!=null&&hg.call(e,t)}var Ba=dg;function mg(e,t){return e!=null&&Rn(e,t,Ba)}var T=mg;var gg="[object String]";function xg(e){return typeof e=="string"||!A(e)&&z(e)&&ht(e)==gg}var nt=xg;function Eg(e,t){return wt(t,function(r){return e[r]})}var Wa=Eg;function Tg(e){return e==null?[]:Wa(e,P(e))}var L=Tg;var Ag=Math.max;function Ig(e,t,r,n){e=Z(e)?e:L(e),r=r&&!n?Ft(r):0;var i=e.length;return r<0&&(r=Ag(i+r,0)),nt(e)?r<=i&&e.indexOf(t,r)>-1:!!i&&Ue(e,t,r)>-1}var G=Ig;var yg=Math.max;function Rg(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var i=r==null?0:Ft(r);return i<0&&(i=yg(n+i,0)),Ue(e,t,i)}var Nn=Rg;var Sg="[object Map]",Og="[object Set]",Ng=Object.prototype,_g=Ng.hasOwnProperty;function Cg(e){if(e==null)return!0;if(Z(e)&&(A(e)||typeof e=="string"||typeof e.splice=="function"||qt(e)||Be(e)||ce(e)))return!e.length;var t=Pt(e);if(t==Sg||t==Og)return!e.size;if(Gt(e))return!sn(e).length;for(var r in e)if(_g.call(e,r))return!1;return!0}var _=Cg;var vg="[object RegExp]";function bg(e){return z(e)&&ht(e)==vg}var ja=bg;var Ka=Ct&&Ct.isRegExp,Lg=Ka?$t(Ka):ja,vt=Lg;function Pg(e){return e===void 0}var ut=Pg;var kg="Expected a function";function Mg(e){if(typeof e!="function")throw new TypeError(kg);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var Ha=Mg;function wg(e,t,r,n){if(!B(e))return e;t=me(t,e);for(var i=-1,o=t.length,s=o-1,a=e;a!=null&&++i<o;){var l=Bt(t[i]),c=r;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(i!=s){var f=a[l];c=n?n(f,l,a):void 0,c===void 0&&(c=B(f)?f:se(t[i+1])?[]:{})}ae(a,l,c),a=a[l]}return e}var za=wg;function Fg(e,t,r){for(var n=-1,i=t.length,o={};++n<i;){var s=t[n],a=ze(e,s);r(a,s)&&za(o,me(s,e),a)}return o}var Va=Fg;function Ug(e,t){if(e==null)return{};var r=wt(pn(e),function(n){return[n]});return t=Q(t),Va(e,r,function(n,i){return t(n,i[0])})}var yt=Ug;function Dg(e,t,r,n,i){return i(e,function(o,s,a){r=n?(n=!1,o):t(r,o,s,a)}),r}var Ya=Dg;function Gg(e,t,r){var n=A(e)?As:Ya,i=arguments.length<3;return n(e,Q(t,4),r,i,It)}var tt=Gg;function $g(e,t){var r=A(e)?qe:On;return r(e,Ha(Q(t,3)))}var Te=$g;function Bg(e,t){var r;return It(e,function(n,i,o){return r=t(n,i,o),!r}),!!r}var Xa=Bg;function Wg(e,t,r){var n=A(e)?xn:Xa;return r&&le(e,t,r)&&(t=void 0),n(e,Q(t,3))}var Or=Wg;var jg=1/0,Kg=xe&&1/rr(new xe([,-0]))[1]==jg?function(e){return new xe(e)}:W,qa=Kg;var Hg=200;function zg(e,t,r){var n=-1,i=rn,o=e.length,s=!0,a=[],l=a;if(r)s=!1,i=Sn;else if(o>=Hg){var c=t?null:qa(e);if(c)return rr(c);s=!1,i=er,l=new tr}else l=t?[]:a;t:for(;++n<o;){var f=e[n],u=t?t(f):f;if(f=r||f!==0?f:0,s&&u===u){for(var p=l.length;p--;)if(l[p]===u)continue t;t&&l.push(u),a.push(f)}else i(l,u,r)||(l!==a&&l.push(u),a.push(f))}return a}var Ja=zg;function Vg(e){return e&&e.length?Ja(e):[]}var ir=Vg;function or(e){console&&console.error&&console.error(`Error: ${e}`)}function Nr(e){console&&console.warn&&console.warn(`Warning: ${e}`)}function _r(e){let t=new Date().getTime(),r=e();return{time:new Date().getTime()-t,value:r}}function Cr(e){function t(){}t.prototype=e;let r=new t;function n(){return typeof r.bar}return n(),n(),e;(0,eval)(e)}function Yg(e){return Xg(e)?e.LABEL:e.name}function Xg(e){return nt(e.LABEL)&&e.LABEL!==""}var Ot=class{get definition(){return this._definition}set definition(t){this._definition=t}constructor(t){this._definition=t}accept(t){t.visit(this),x(this.definition,r=>{r.accept(t)})}},w=class extends Ot{constructor(t){super([]),this.idx=1,at(this,yt(t,r=>r!==void 0))}set definition(t){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(t){t.visit(this)}},gt=class extends Ot{constructor(t){super(t.definition),this.orgText="",at(this,yt(t,r=>r!==void 0))}},F=class extends Ot{constructor(t){super(t.definition),this.ignoreAmbiguities=!1,at(this,yt(t,r=>r!==void 0))}},D=class extends Ot{constructor(t){super(t.definition),this.idx=1,at(this,yt(t,r=>r!==void 0))}},Y=class extends Ot{constructor(t){super(t.definition),this.idx=1,at(this,yt(t,r=>r!==void 0))}},X=class extends Ot{constructor(t){super(t.definition),this.idx=1,at(this,yt(t,r=>r!==void 0))}},v=class extends Ot{constructor(t){super(t.definition),this.idx=1,at(this,yt(t,r=>r!==void 0))}},K=class extends Ot{constructor(t){super(t.definition),this.idx=1,at(this,yt(t,r=>r!==void 0))}},H=class extends Ot{get definition(){return this._definition}set definition(t){this._definition=t}constructor(t){super(t.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,at(this,yt(t,r=>r!==void 0))}},C=class{constructor(t){this.idx=1,at(this,yt(t,r=>r!==void 0))}accept(t){t.visit(this)}};function _n(e){return g(e,sr)}function sr(e){function t(r){return g(r,sr)}if(e instanceof w){let r={type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};return nt(e.label)&&(r.label=e.label),r}else{if(e instanceof F)return{type:"Alternative",definition:t(e.definition)};if(e instanceof D)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof Y)return{type:"RepetitionMandatory",idx:e.idx,definition:t(e.definition)};if(e instanceof X)return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:sr(new C({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof K)return{type:"RepetitionWithSeparator",idx:e.idx,separator:sr(new C({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof v)return{type:"Repetition",idx:e.idx,definition:t(e.definition)};if(e instanceof H)return{type:"Alternation",idx:e.idx,definition:t(e.definition)};if(e instanceof C){let r={type:"Terminal",name:e.terminalType.name,label:Yg(e.terminalType),idx:e.idx};nt(e.label)&&(r.terminalLabel=e.label);let n=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(r.pattern=vt(n)?n.source:n),r}else{if(e instanceof gt)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}}}var xt=class{visit(t){let r=t;switch(r.constructor){case w:return this.visitNonTerminal(r);case F:return this.visitAlternative(r);case D:return this.visitOption(r);case Y:return this.visitRepetitionMandatory(r);case X:return this.visitRepetitionMandatoryWithSeparator(r);case K:return this.visitRepetitionWithSeparator(r);case v:return this.visitRepetition(r);case H:return this.visitAlternation(r);case C:return this.visitTerminal(r);case gt:return this.visitRule(r);default:throw Error("non exhaustive match")}}visitNonTerminal(t){}visitAlternative(t){}visitOption(t){}visitRepetition(t){}visitRepetitionMandatory(t){}visitRepetitionMandatoryWithSeparator(t){}visitRepetitionWithSeparator(t){}visitAlternation(t){}visitTerminal(t){}visitRule(t){}};function Ii(e){return e instanceof F||e instanceof D||e instanceof v||e instanceof Y||e instanceof X||e instanceof K||e instanceof C||e instanceof gt}function Ne(e,t=[]){return e instanceof D||e instanceof v||e instanceof K?!0:e instanceof H?Or(e.definition,n=>Ne(n,t)):e instanceof w&&G(t,e)?!1:e instanceof Ot?(e instanceof w&&t.push(e),ct(e.definition,n=>Ne(n,t))):!1}function yi(e){return e instanceof H}function Rt(e){if(e instanceof w)return"SUBRULE";if(e instanceof D)return"OPTION";if(e instanceof H)return"OR";if(e instanceof Y)return"AT_LEAST_ONE";if(e instanceof X)return"AT_LEAST_ONE_SEP";if(e instanceof K)return"MANY_SEP";if(e instanceof v)return"MANY";if(e instanceof C)return"CONSUME";throw Error("non exhaustive match")}var Qt=class{walk(t,r=[]){x(t.definition,(n,i)=>{let o=V(t.definition,i+1);if(n instanceof w)this.walkProdRef(n,o,r);else if(n instanceof C)this.walkTerminal(n,o,r);else if(n instanceof F)this.walkFlat(n,o,r);else if(n instanceof D)this.walkOption(n,o,r);else if(n instanceof Y)this.walkAtLeastOne(n,o,r);else if(n instanceof X)this.walkAtLeastOneSep(n,o,r);else if(n instanceof K)this.walkManySep(n,o,r);else if(n instanceof v)this.walkMany(n,o,r);else if(n instanceof H)this.walkOr(n,o,r);else throw Error("non exhaustive match")})}walkTerminal(t,r,n){}walkProdRef(t,r,n){}walkFlat(t,r,n){let i=r.concat(n);this.walk(t,i)}walkOption(t,r,n){let i=r.concat(n);this.walk(t,i)}walkAtLeastOne(t,r,n){let i=[new D({definition:t.definition})].concat(r,n);this.walk(t,i)}walkAtLeastOneSep(t,r,n){let i=Za(t,r,n);this.walk(t,i)}walkMany(t,r,n){let i=[new D({definition:t.definition})].concat(r,n);this.walk(t,i)}walkManySep(t,r,n){let i=Za(t,r,n);this.walk(t,i)}walkOr(t,r,n){let i=r.concat(n);x(t.definition,o=>{let s=new F({definition:[o]});this.walk(s,i)})}};function Za(e,t,r){return[new D({definition:[new C({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}function _e(e){if(e instanceof w)return _e(e.referencedRule);if(e instanceof C)return Zg(e);if(Ii(e))return qg(e);if(yi(e))return Jg(e);throw Error("non exhaustive match")}function qg(e){let t=[],r=e.definition,n=0,i=r.length>n,o,s=!0;for(;i&&s;)o=r[n],s=Ne(o),t=t.concat(_e(o)),n=n+1,i=r.length>n;return ir(t)}function Jg(e){let t=g(e.definition,r=>_e(r));return ir(rt(t))}function Zg(e){return[e.terminalType]}var Cn="_~IN~_";var Ri=class extends Qt{constructor(t){super(),this.topProd=t,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(t,r,n){}walkProdRef(t,r,n){let i=Qg(t.referencedRule,t.idx)+this.topProd.name,o=r.concat(n),s=new F({definition:o}),a=_e(s);this.follows[i]=a}};function Qa(e){let t={};return x(e,r=>{let n=new Ri(r).startWalking();at(t,n)}),t}function Qg(e,t){return e.name+t+Cn}function R(e){return e.charCodeAt(0)}function vn(e,t){Array.isArray(e)?e.forEach(function(r){t.push(r)}):t.push(e)}function ar(e,t){if(e[t]===!0)throw"duplicate flag "+t;let r=e[t];e[t]=!0}function Ce(e){if(e===void 0)throw Error("Internal Error - Should never get here!");return!0}function vr(){throw Error("Internal Error - Should never get here!")}function Si(e){return e.type==="Character"}var br=[];for(let e=R("0");e<=R("9");e++)br.push(e);var Lr=[R("_")].concat(br);for(let e=R("a");e<=R("z");e++)Lr.push(e);for(let e=R("A");e<=R("Z");e++)Lr.push(e);var Oi=[R(" "),R("\f"),R(`
`),R("\r"),R("	"),R("\v"),R("	"),R("\xA0"),R("\u1680"),R("\u2000"),R("\u2001"),R("\u2002"),R("\u2003"),R("\u2004"),R("\u2005"),R("\u2006"),R("\u2007"),R("\u2008"),R("\u2009"),R("\u200A"),R("\u2028"),R("\u2029"),R("\u202F"),R("\u205F"),R("\u3000"),R("\uFEFF")];var tx=/[0-9a-fA-F]/,bn=/[0-9]/,ex=/[1-9]/,Pr=class{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(t){this.idx=t.idx,this.input=t.input,this.groupIdx=t.groupIdx}pattern(t){this.idx=0,this.input=t,this.groupIdx=0,this.consumeChar("/");let r=this.disjunction();this.consumeChar("/");let n={type:"Flags",loc:{begin:this.idx,end:t.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":ar(n,"global");break;case"i":ar(n,"ignoreCase");break;case"m":ar(n,"multiLine");break;case"u":ar(n,"unicode");break;case"y":ar(n,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:r,loc:this.loc(0)}}disjunction(){let t=[],r=this.idx;for(t.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),t.push(this.alternative());return{type:"Disjunction",value:t,loc:this.loc(r)}}alternative(){let t=[],r=this.idx;for(;this.isTerm();)t.push(this.term());return{type:"Alternative",value:t,loc:this.loc(r)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){let t=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(t)};case"$":return{type:"EndAnchor",loc:this.loc(t)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(t)};case"B":return{type:"NonWordBoundary",loc:this.loc(t)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let r;switch(this.popChar()){case"=":r="Lookahead";break;case"!":r="NegativeLookahead";break}Ce(r);let n=this.disjunction();return this.consumeChar(")"),{type:r,value:n,loc:this.loc(t)}}return vr()}quantifier(t=!1){let r,n=this.idx;switch(this.popChar()){case"*":r={atLeast:0,atMost:1/0};break;case"+":r={atLeast:1,atMost:1/0};break;case"?":r={atLeast:0,atMost:1};break;case"{":let i=this.integerIncludingZero();switch(this.popChar()){case"}":r={atLeast:i,atMost:i};break;case",":let o;this.isDigit()?(o=this.integerIncludingZero(),r={atLeast:i,atMost:o}):r={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(t===!0&&r===void 0)return;Ce(r);break}if(!(t===!0&&r===void 0)&&Ce(r))return this.peekChar(0)==="?"?(this.consumeChar("?"),r.greedy=!1):r.greedy=!0,r.type="Quantifier",r.loc=this.loc(n),r}atom(){let t,r=this.idx;switch(this.peekChar()){case".":t=this.dotAll();break;case"\\":t=this.atomEscape();break;case"[":t=this.characterClass();break;case"(":t=this.group();break}return t===void 0&&this.isPatternCharacter()&&(t=this.patternCharacter()),Ce(t)?(t.loc=this.loc(r),this.isQuantifier()&&(t.quantifier=this.quantifier()),t):vr()}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[R(`
`),R("\r"),R("\u2028"),R("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let t,r=!1;switch(this.popChar()){case"d":t=br;break;case"D":t=br,r=!0;break;case"s":t=Oi;break;case"S":t=Oi,r=!0;break;case"w":t=Lr;break;case"W":t=Lr,r=!0;break}return Ce(t)?{type:"Set",value:t,complement:r}:vr()}controlEscapeAtom(){let t;switch(this.popChar()){case"f":t=R("\f");break;case"n":t=R(`
`);break;case"r":t=R("\r");break;case"t":t=R("	");break;case"v":t=R("\v");break}return Ce(t)?{type:"Character",value:t}:vr()}controlLetterEscapeAtom(){this.consumeChar("c");let t=this.popChar();if(/[a-zA-Z]/.test(t)===!1)throw Error("Invalid ");return{type:"Character",value:t.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:R("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){let t=this.popChar();return{type:"Character",value:R(t)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:let t=this.popChar();return{type:"Character",value:R(t)}}}characterClass(){let t=[],r=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),r=!0);this.isClassAtom();){let n=this.classAtom(),i=n.type==="Character";if(Si(n)&&this.isRangeDash()){this.consumeChar("-");let o=this.classAtom(),s=o.type==="Character";if(Si(o)){if(o.value<n.value)throw Error("Range out of order in character class");t.push({from:n.value,to:o.value})}else vn(n.value,t),t.push(R("-")),vn(o.value,t)}else vn(n.value,t)}return this.consumeChar("]"),{type:"Set",complement:r,value:t}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:R("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let t=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),t=!1;break;default:this.groupIdx++;break}let r=this.disjunction();this.consumeChar(")");let n={type:"Group",capturing:t,value:r};return t&&(n.idx=this.groupIdx),n}positiveInteger(){let t=this.popChar();if(ex.test(t)===!1)throw Error("Expecting a positive integer");for(;bn.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)}integerIncludingZero(){let t=this.popChar();if(bn.test(t)===!1)throw Error("Expecting an integer");for(;bn.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)}patternCharacter(){let t=this.popChar();switch(t){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:R(t)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return bn.test(this.peekChar(0))}isClassAtom(t=0){switch(this.peekChar(t)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){let t=this.saveState();try{return this.quantifier(!0)!==void 0}catch (e7){return!1}finally{this.restoreState(t)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(t){let r="";for(let i=0;i<t;i++){let o=this.popChar();if(tx.test(o)===!1)throw Error("Expecting a HexDecimal digits");r+=o}return{type:"Character",value:parseInt(r,16)}}peekChar(t=0){return this.input[this.idx+t]}popChar(){let t=this.peekChar(0);return this.consumeChar(void 0),t}consumeChar(t){if(t!==void 0&&this.input[this.idx]!==t)throw Error("Expected: '"+t+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(t){return{begin:t,end:this.idx}}};var Ae=class{visitChildren(t){for(let r in t){let n=t[r];t.hasOwnProperty(r)&&(n.type!==void 0?this.visit(n):Array.isArray(n)&&n.forEach(i=>{this.visit(i)},this))}}visit(t){switch(t.type){case"Pattern":this.visitPattern(t);break;case"Flags":this.visitFlags(t);break;case"Disjunction":this.visitDisjunction(t);break;case"Alternative":this.visitAlternative(t);break;case"StartAnchor":this.visitStartAnchor(t);break;case"EndAnchor":this.visitEndAnchor(t);break;case"WordBoundary":this.visitWordBoundary(t);break;case"NonWordBoundary":this.visitNonWordBoundary(t);break;case"Lookahead":this.visitLookahead(t);break;case"NegativeLookahead":this.visitNegativeLookahead(t);break;case"Character":this.visitCharacter(t);break;case"Set":this.visitSet(t);break;case"Group":this.visitGroup(t);break;case"GroupBackReference":this.visitGroupBackReference(t);break;case"Quantifier":this.visitQuantifier(t);break}this.visitChildren(t)}visitPattern(t){}visitFlags(t){}visitDisjunction(t){}visitAlternative(t){}visitStartAnchor(t){}visitEndAnchor(t){}visitWordBoundary(t){}visitNonWordBoundary(t){}visitLookahead(t){}visitNegativeLookahead(t){}visitCharacter(t){}visitSet(t){}visitGroup(t){}visitGroupBackReference(t){}visitQuantifier(t){}};var Ln={},rx=new Pr;function lr(e){let t=e.toString();if(Ln.hasOwnProperty(t))return Ln[t];{let r=rx.pattern(t);return Ln[t]=r,r}}function tl(){Ln={}}var rl="Complement Sets are not supported for first char optimization",kr=`Unable to use "first char" lexer optimizations:
`;function nl(e,t=!1){try{let r=lr(e);return Ni(r.value,{},r.flags.ignoreCase)}catch(r){if(r.message===rl)t&&Nr(`${kr}	Unable to optimize: < ${e.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let n="";t&&(n=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),or(`${kr}
	Failed parsing: < ${e.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+n)}}return[]}function Ni(e,t,r){switch(e.type){case"Disjunction":for(let i=0;i<e.value.length;i++)Ni(e.value[i],t,r);break;case"Alternative":let n=e.value;for(let i=0;i<n.length;i++){let o=n[i];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}let s=o;switch(s.type){case"Character":Pn(s.value,t,r);break;case"Set":if(s.complement===!0)throw Error(rl);x(s.value,l=>{if(typeof l=="number")Pn(l,t,r);else{let c=l;if(r===!0)for(let f=c.from;f<=c.to;f++)Pn(f,t,r);else{for(let f=c.from;f<=c.to&&f<cr;f++)Pn(f,t,r);if(c.to>=cr){let f=c.from>=cr?c.from:cr,u=c.to,p=Ht(f),d=Ht(u);for(let I=p;I<=d;I++)t[I]=I}}}});break;case"Group":Ni(s.value,t,r);break;default:throw Error("Non Exhaustive Match")}let a=s.quantifier!==void 0&&s.quantifier.atLeast===0;if(s.type==="Group"&&_i(s)===!1||s.type!=="Group"&&a===!1)break}break;default:throw Error("non exhaustive match!")}return L(t)}function Pn(e,t,r){let n=Ht(e);t[n]=n,r===!0&&nx(e,t)}function nx(e,t){let r=String.fromCharCode(e),n=r.toUpperCase();if(n!==r){let i=Ht(n.charCodeAt(0));t[i]=i}else{let i=r.toLowerCase();if(i!==r){let o=Ht(i.charCodeAt(0));t[o]=o}}}function el(e,t){return Kt(e.value,r=>{if(typeof r=="number")return G(t,r);{let n=r;return Kt(t,i=>n.from<=i&&i<=n.to)!==void 0}})}function _i(e){let t=e.quantifier;return t&&t.atLeast===0?!0:e.value?A(e.value)?ct(e.value,_i):_i(e.value):!1}var Ci=class extends Ae{constructor(t){super(),this.targetCharCodes=t,this.found=!1}visitChildren(t){if(this.found!==!0){switch(t.type){case"Lookahead":this.visitLookahead(t);return;case"NegativeLookahead":this.visitNegativeLookahead(t);return}super.visitChildren(t)}}visitCharacter(t){G(this.targetCharCodes,t.value)&&(this.found=!0)}visitSet(t){t.complement?el(t,this.targetCharCodes)===void 0&&(this.found=!0):el(t,this.targetCharCodes)!==void 0&&(this.found=!0)}};function kn(e,t){if(t instanceof RegExp){let r=lr(t),n=new Ci(e);return n.visit(r),n.found}else return Kt(t,r=>G(e,r.charCodeAt(0)))!==void 0}var ve="PATTERN",fr="defaultMode",Mn="modes",bi=typeof new RegExp("(?:)").sticky=="boolean";function sl(e,t){t=nr(t,{useSticky:bi,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(m,h)=>h()});let r=t.tracer;r("initCharCodeToOptimizedIndexMap",()=>{Ix()});let n;r("Reject Lexer.NA",()=>{n=Te(e,m=>m[ve]===et.NA)});let i=!1,o;r("Transform Patterns",()=>{i=!1,o=g(n,m=>{let h=m[ve];if(vt(h)){let O=h.source;return O.length===1&&O!=="^"&&O!=="$"&&O!=="."&&!h.ignoreCase?O:O.length===2&&O[0]==="\\"&&!G(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],O[1])?O[1]:t.useSticky?ol(h):il(h)}else{if(dt(h))return i=!0,{exec:h};if(typeof h=="object")return i=!0,h;if(typeof h=="string"){if(h.length===1)return h;{let O=h.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),N=new RegExp(O);return t.useSticky?ol(N):il(N)}}else throw Error("non exhaustive match")}})});let s,a,l,c,f;r("misc mapping",()=>{s=g(n,m=>m.tokenTypeIdx),a=g(n,m=>{let h=m.GROUP;if(h!==et.SKIPPED){if(nt(h))return h;if(ut(h))return!1;throw Error("non exhaustive match")}}),l=g(n,m=>{let h=m.LONGER_ALT;if(h)return A(h)?g(h,N=>Nn(n,N)):[Nn(n,h)]}),c=g(n,m=>m.PUSH_MODE),f=g(n,m=>T(m,"POP_MODE"))});let u;r("Line Terminator Handling",()=>{let m=dl(t.lineTerminatorCharacters);u=g(n,h=>!1),t.positionTracking!=="onlyOffset"&&(u=g(n,h=>T(h,"LINE_BREAKS")?!!h.LINE_BREAKS:hl(h,m)===!1&&kn(m,h.PATTERN)))});let p,d,I,y;r("Misc Mapping #2",()=>{p=g(n,ul),d=g(o,Tx),I=tt(n,(m,h)=>{let O=h.GROUP;return nt(O)&&O!==et.SKIPPED&&(m[O]=[]),m},{}),y=g(o,(m,h)=>({pattern:o[h],longerAlt:l[h],canLineTerminator:u[h],isCustom:p[h],short:d[h],group:a[h],push:c[h],pop:f[h],tokenTypeIdx:s[h],tokenType:n[h]}))});let S=!0,E=[];return t.safeMode||r("First Char Optimization",()=>{E=tt(n,(m,h,O)=>{if(typeof h.PATTERN=="string"){let N=h.PATTERN.charCodeAt(0),Tt=Ht(N);vi(m,Tt,y[O])}else if(A(h.START_CHARS_HINT)){let N;x(h.START_CHARS_HINT,Tt=>{let Vr=typeof Tt=="string"?Tt.charCodeAt(0):Tt,bt=Ht(Vr);N!==bt&&(N=bt,vi(m,bt,y[O]))})}else if(vt(h.PATTERN))if(h.PATTERN.unicode)S=!1,t.ensureOptimizations&&or(`${kr}	Unable to analyze < ${h.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{let N=nl(h.PATTERN,t.ensureOptimizations);_(N)&&(S=!1),x(N,Tt=>{vi(m,Tt,y[O])})}else t.ensureOptimizations&&or(`${kr}	TokenType: <${h.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),S=!1;return m},[])}),{emptyGroups:I,patternIdxToConfig:y,charCodeToPatternIdxToConfig:E,hasCustom:i,canBeOptimized:S}}function al(e,t){let r=[],n=ox(e);r=r.concat(n.errors);let i=sx(n.valid),o=i.valid;return r=r.concat(i.errors),r=r.concat(ix(o)),r=r.concat(dx(o)),r=r.concat(mx(o,t)),r=r.concat(gx(o)),r}function ix(e){let t=[],r=ft(e,n=>vt(n[ve]));return t=t.concat(lx(r)),t=t.concat(ux(r)),t=t.concat(px(r)),t=t.concat(hx(r)),t=t.concat(cx(r)),t}function ox(e){let t=ft(e,i=>!T(i,ve)),r=g(t,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:$.MISSING_PATTERN,tokenTypes:[i]})),n=Ee(e,t);return{errors:r,valid:n}}function sx(e){let t=ft(e,i=>{let o=i[ve];return!vt(o)&&!dt(o)&&!T(o,"exec")&&!nt(o)}),r=g(t,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:$.INVALID_PATTERN,tokenTypes:[i]})),n=Ee(e,t);return{errors:r,valid:n}}var ax=/[^\\][$]/;function lx(e){class t extends Ae{constructor(){super(...arguments),this.found=!1}visitEndAnchor(o){this.found=!0}}let r=ft(e,i=>{let o=i.PATTERN;try{let s=lr(o),a=new t;return a.visit(s),a.found}catch (e8){return ax.test(o.source)}});return g(r,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:$.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function cx(e){let t=ft(e,n=>n.PATTERN.test(""));return g(t,n=>({message:"Token Type: ->"+n.name+"<- static 'PATTERN' must not match an empty string",type:$.EMPTY_MATCH_PATTERN,tokenTypes:[n]}))}var fx=/[^\\[][\^]|^\^/;function ux(e){class t extends Ae{constructor(){super(...arguments),this.found=!1}visitStartAnchor(o){this.found=!0}}let r=ft(e,i=>{let o=i.PATTERN;try{let s=lr(o),a=new t;return a.visit(s),a.found}catch (e9){return fx.test(o.source)}});return g(r,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:$.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function px(e){let t=ft(e,n=>{let i=n[ve];return i instanceof RegExp&&(i.multiline||i.global)});return g(t,n=>({message:"Token Type: ->"+n.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:$.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[n]}))}function hx(e){let t=[],r=g(e,o=>tt(e,(s,a)=>(o.PATTERN.source===a.PATTERN.source&&!G(t,a)&&a.PATTERN!==et.NA&&(t.push(a),s.push(a)),s),[]));r=Wt(r);let n=ft(r,o=>o.length>1);return g(n,o=>{let s=g(o,l=>l.name);return{message:`The same RegExp pattern ->${st(o).PATTERN}<-has been used in all of the following Token Types: ${s.join(", ")} <-`,type:$.DUPLICATE_PATTERNS_FOUND,tokenTypes:o}})}function dx(e){let t=ft(e,n=>{if(!T(n,"GROUP"))return!1;let i=n.GROUP;return i!==et.SKIPPED&&i!==et.NA&&!nt(i)});return g(t,n=>({message:"Token Type: ->"+n.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:$.INVALID_GROUP_TYPE_FOUND,tokenTypes:[n]}))}function mx(e,t){let r=ft(e,i=>i.PUSH_MODE!==void 0&&!G(t,i.PUSH_MODE));return g(r,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:$.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function gx(e){let t=[],r=tt(e,(n,i,o)=>{let s=i.PATTERN;return s===et.NA||(nt(s)?n.push({str:s,idx:o,tokenType:i}):vt(s)&&Ex(s)&&n.push({str:s.source,idx:o,tokenType:i})),n},[]);return x(e,(n,i)=>{x(r,({str:o,idx:s,tokenType:a})=>{if(i<s&&xx(o,n.PATTERN)){let l=`Token: ->${a.name}<- can never be matched.
Because it appears AFTER the Token Type ->${n.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;t.push({message:l,type:$.UNREACHABLE_PATTERN,tokenTypes:[n,a]})}})}),t}function xx(e,t){if(vt(t)){let r=t.exec(e);return r!==null&&r.index===0}else{if(dt(t))return t(e,0,[],{});if(T(t,"exec"))return t.exec(e,0,[],{});if(typeof t=="string")return t===e;throw Error("non exhaustive match")}}function Ex(e){return Kt([".","\\","[","]","|","^","$","(",")","?","*","+","{"],r=>e.source.indexOf(r)!==-1)===void 0}function il(e){let t=e.ignoreCase?"i":"";return new RegExp(`^(?:${e.source})`,t)}function ol(e){let t=e.ignoreCase?"iy":"y";return new RegExp(`${e.source}`,t)}function ll(e,t,r){let n=[];return T(e,fr)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+fr+`> property in its definition
`,type:$.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),T(e,Mn)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+Mn+`> property in its definition
`,type:$.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),T(e,Mn)&&T(e,fr)&&!T(e.modes,e.defaultMode)&&n.push({message:`A MultiMode Lexer cannot be initialized with a ${fr}: <${e.defaultMode}>which does not exist
`,type:$.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),T(e,Mn)&&x(e.modes,(i,o)=>{x(i,(s,a)=>{if(ut(s))n.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${o}> at index: <${a}>
`,type:$.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(T(s,"LONGER_ALT")){let l=A(s.LONGER_ALT)?s.LONGER_ALT:[s.LONGER_ALT];x(l,c=>{!ut(c)&&!G(i,c)&&n.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${c.name}> on token <${s.name}> outside of mode <${o}>
`,type:$.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),n}function cl(e,t,r){let n=[],i=!1,o=Wt(rt(L(e.modes))),s=Te(o,l=>l[ve]===et.NA),a=dl(r);return t&&x(s,l=>{let c=hl(l,a);if(c!==!1){let u={message:Ax(l,c),type:c.issue,tokenType:l};n.push(u)}else T(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):kn(a,l.PATTERN)&&(i=!0)}),t&&!i&&n.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:$.NO_LINE_BREAKS_FLAGS}),n}function fl(e){let t={},r=P(e);return x(r,n=>{let i=e[n];if(A(i))t[n]=[];else throw Error("non exhaustive match")}),t}function ul(e){let t=e.PATTERN;if(vt(t))return!1;if(dt(t))return!0;if(T(t,"exec"))return!0;if(nt(t))return!1;throw Error("non exhaustive match")}function Tx(e){return nt(e)&&e.length===1?e.charCodeAt(0):!1}var pl={test:function(e){let t=e.length;for(let r=this.lastIndex;r<t;r++){let n=e.charCodeAt(r);if(n===10)return this.lastIndex=r+1,!0;if(n===13)return e.charCodeAt(r+1)===10?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function hl(e,t){if(T(e,"LINE_BREAKS"))return!1;if(vt(e.PATTERN)){try{kn(t,e.PATTERN)}catch(r){return{issue:$.IDENTIFY_TERMINATOR,errMsg:r.message}}return!1}else{if(nt(e.PATTERN))return!1;if(ul(e))return{issue:$.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function Ax(e,t){if(t.issue===$.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${e.name}> Token Type
	 Root cause: ${t.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(t.issue===$.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${e.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function dl(e){return g(e,r=>nt(r)?r.charCodeAt(0):r)}function vi(e,t,r){e[t]===void 0?e[t]=[r]:e[t].push(r)}var cr=256,wn=[];function Ht(e){return e<cr?e:wn[e]}function Ix(){if(_(wn)){wn=new Array(65536);for(let e=0;e<65536;e++)wn[e]=e>255?255+~~(e/255):e}}function te(e,t){let r=e.tokenTypeIdx;return r===t.tokenTypeIdx?!0:t.isParent===!0&&t.categoryMatchesMap[r]===!0}function ur(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var ml=1,xl={};function ee(e){let t=yx(e);Rx(t),Ox(t),Sx(t),x(t,r=>{r.isParent=r.categoryMatches.length>0})}function yx(e){let t=M(e),r=e,n=!0;for(;n;){r=Wt(rt(g(r,o=>o.CATEGORIES)));let i=Ee(r,t);t=t.concat(i),_(i)?n=!1:r=i}return t}function Rx(e){x(e,t=>{Li(t)||(xl[ml]=t,t.tokenTypeIdx=ml++),gl(t)&&!A(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),gl(t)||(t.CATEGORIES=[]),Nx(t)||(t.categoryMatches=[]),_x(t)||(t.categoryMatchesMap={})})}function Sx(e){x(e,t=>{t.categoryMatches=[],x(t.categoryMatchesMap,(r,n)=>{t.categoryMatches.push(xl[n].tokenTypeIdx)})})}function Ox(e){x(e,t=>{El([],t)})}function El(e,t){x(e,r=>{t.categoryMatchesMap[r.tokenTypeIdx]=!0}),x(t.CATEGORIES,r=>{let n=e.concat(t);G(n,r)||El(n,r)})}function Li(e){return T(e,"tokenTypeIdx")}function gl(e){return T(e,"CATEGORIES")}function Nx(e){return T(e,"categoryMatches")}function _x(e){return T(e,"categoryMatchesMap")}function Tl(e){return T(e,"tokenTypeIdx")}var Pi={buildUnableToPopLexerModeMessage(e){return`Unable to pop Lexer Mode after encountering Token ->${e.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(e,t,r,n,i){return`unexpected character: ->${e.charAt(t)}<- at offset: ${t}, skipped ${r} characters.`}};var $;(function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",e[e.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})($||($={}));var Mr={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:Pi,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(Mr);var et=class{constructor(t,r=Mr){if(this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,o)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;let s=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${s}--> <${i}>`);let{time:a,value:l}=_r(o),c=a>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(`${s}<-- <${i}> time: ${a}ms`),this.traceInitIndent--,l}else return o()},typeof r=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=at({},Mr,r);let n=this.config.traceInitPerf;n===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof n=="number"&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,o=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===Mr.lineTerminatorsPattern)this.config.lineTerminatorsPattern=pl;else if(this.config.lineTerminatorCharacters===Mr.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(r.safeMode&&r.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),A(t)?i={modes:{defaultMode:M(t)},defaultMode:fr}:(o=!1,i=M(t))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(ll(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(cl(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},x(i.modes,(a,l)=>{i.modes[l]=Te(a,c=>ut(c))});let s=P(i.modes);if(x(i.modes,(a,l)=>{this.TRACE_INIT(`Mode: <${l}> processing`,()=>{if(this.modes.push(l),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(al(a,s))}),_(this.lexerDefinitionErrors)){ee(a);let c;this.TRACE_INIT("analyzeTokenTypes",()=>{c=sl(a,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:r.positionTracking,ensureOptimizations:r.ensureOptimizations,safeMode:r.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[l]=c.patternIdxToConfig,this.charCodeToPatternIdxToConfig[l]=c.charCodeToPatternIdxToConfig,this.emptyGroups=at({},this.emptyGroups,c.emptyGroups),this.hasCustom=c.hasCustom||this.hasCustom,this.canModeBeOptimized[l]=c.canBeOptimized}})}),this.defaultMode=i.defaultMode,!_(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){let l=g(this.lexerDefinitionErrors,c=>c.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+l)}x(this.lexerDefinitionWarning,a=>{Nr(a.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(bi?(this.chopInput=_t,this.match=this.matchWithTest):(this.updateLastIndex=W,this.match=this.matchWithExec),o&&(this.handleModes=W),this.trackStartLines===!1&&(this.computeNewColumn=_t),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=W),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{let a=tt(this.canModeBeOptimized,(l,c,f)=>(c===!1&&l.push(f),l),[]);if(r.ensureOptimizations&&!_(a))throw Error(`Lexer Modes: < ${a.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{tl()}),this.TRACE_INIT("toFastProperties",()=>{Cr(this)})})}tokenize(t,r=this.defaultMode){if(!_(this.lexerDefinitionErrors)){let i=g(this.lexerDefinitionErrors,o=>o.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(t,r)}tokenizeInternal(t,r){let n,i,o,s,a,l,c,f,u,p,d,I,y,S,E,m,h=t,O=h.length,N=0,Tt=0,Vr=this.hasCustom?0:Math.floor(t.length/10),bt=new Array(Vr),Er=[],ye=this.trackStartLines?1:void 0,re=this.trackStartLines?1:void 0,Tr=fl(this.emptyGroups),cc=this.trackStartLines,pi=this.config.lineTerminatorsPattern,Yr=0,ne=[],Ar=[],Xr=[],to=[];Object.freeze(to);let Ir;function eo(){return ne}function ro(lt){let Nt=Ht(lt),we=Ar[Nt];return we===void 0?to:we}let fc=lt=>{if(Xr.length===1&&lt.tokenType.PUSH_MODE===void 0){let Nt=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(lt);Er.push({offset:lt.startOffset,line:lt.startLine,column:lt.startColumn,length:lt.image.length,message:Nt})}else{Xr.pop();let Nt=jt(Xr);ne=this.patternIdxToConfig[Nt],Ar=this.charCodeToPatternIdxToConfig[Nt],Yr=ne.length;let we=this.canModeBeOptimized[Nt]&&this.config.safeMode===!1;Ar&&we?Ir=ro:Ir=eo}};function no(lt){Xr.push(lt),Ar=this.charCodeToPatternIdxToConfig[lt],ne=this.patternIdxToConfig[lt],Yr=ne.length,Yr=ne.length;let Nt=this.canModeBeOptimized[lt]&&this.config.safeMode===!1;Ar&&Nt?Ir=ro:Ir=eo}no.call(this,r);let Lt,io=this.config.recoveryEnabled;for(;N<O;){l=null;let lt=h.charCodeAt(N),Nt=Ir(lt),we=Nt.length;for(n=0;n<we;n++){Lt=Nt[n];let St=Lt.pattern;c=null;let Vt=Lt.short;if(Vt!==!1?lt===Vt&&(l=St):Lt.isCustom===!0?(m=St.exec(h,N,bt,Tr),m!==null?(l=m[0],m.payload!==void 0&&(c=m.payload)):l=null):(this.updateLastIndex(St,N),l=this.match(St,t,N)),l!==null){if(a=Lt.longerAlt,a!==void 0){let ie=a.length;for(o=0;o<ie;o++){let Yt=ne[a[o]],Re=Yt.pattern;if(f=null,Yt.isCustom===!0?(m=Re.exec(h,N,bt,Tr),m!==null?(s=m[0],m.payload!==void 0&&(f=m.payload)):s=null):(this.updateLastIndex(Re,N),s=this.match(Re,t,N)),s&&s.length>l.length){l=s,c=f,Lt=Yt;break}}}break}}if(l!==null){if(u=l.length,p=Lt.group,p!==void 0&&(d=Lt.tokenTypeIdx,I=this.createTokenInstance(l,N,d,Lt.tokenType,ye,re,u),this.handlePayload(I,c),p===!1?Tt=this.addToken(bt,Tt,I):Tr[p].push(I)),t=this.chopInput(t,u),N=N+u,re=this.computeNewColumn(re,u),cc===!0&&Lt.canLineTerminator===!0){let St=0,Vt,ie;pi.lastIndex=0;do Vt=pi.test(l),Vt===!0&&(ie=pi.lastIndex-1,St++);while(Vt===!0);St!==0&&(ye=ye+St,re=u-ie,this.updateTokenEndLineColumnLocation(I,p,ie,St,ye,re,u))}this.handleModes(Lt,fc,no,I)}else{let St=N,Vt=ye,ie=re,Yt=io===!1;for(;Yt===!1&&N<O;)for(t=this.chopInput(t,1),N++,i=0;i<Yr;i++){let Re=ne[i],hi=Re.pattern,oo=Re.short;if(oo!==!1?h.charCodeAt(N)===oo&&(Yt=!0):Re.isCustom===!0?Yt=hi.exec(h,N,bt,Tr)!==null:(this.updateLastIndex(hi,N),Yt=hi.exec(t)!==null),Yt===!0)break}if(y=N-St,re=this.computeNewColumn(re,y),E=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(h,St,y,Vt,ie),Er.push({offset:St,line:Vt,column:ie,length:y,message:E}),io===!1)break}}return this.hasCustom||(bt.length=Tt),{tokens:bt,groups:Tr,errors:Er}}handleModes(t,r,n,i){if(t.pop===!0){let o=t.push;r(i),o!==void 0&&n.call(this,o)}else t.push!==void 0&&n.call(this,t.push)}chopInput(t,r){return t.substring(r)}updateLastIndex(t,r){t.lastIndex=r}updateTokenEndLineColumnLocation(t,r,n,i,o,s,a){let l,c;r!==void 0&&(l=n===a-1,c=l?-1:0,i===1&&l===!0||(t.endLine=o+c,t.endColumn=s-1+-c))}computeNewColumn(t,r){return t+r}createOffsetOnlyToken(t,r,n,i){return{image:t,startOffset:r,tokenTypeIdx:n,tokenType:i}}createStartOnlyToken(t,r,n,i,o,s){return{image:t,startOffset:r,startLine:o,startColumn:s,tokenTypeIdx:n,tokenType:i}}createFullToken(t,r,n,i,o,s,a){return{image:t,startOffset:r,endOffset:r+a-1,startLine:o,endLine:o,startColumn:s,endColumn:s+a-1,tokenTypeIdx:n,tokenType:i}}addTokenUsingPush(t,r,n){return t.push(n),r}addTokenUsingMemberAccess(t,r,n){return t[r]=n,r++,r}handlePayloadNoCustom(t,r){}handlePayloadWithCustom(t,r){r!==null&&(t.payload=r)}matchWithTest(t,r,n){return t.test(r)===!0?r.substring(n,t.lastIndex):null}matchWithExec(t,r){let n=t.exec(r);return n!==null?n[0]:null}};et.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";et.NA=/NOT_APPLICABLE/;function be(e){return ki(e)?e.LABEL:e.name}function ki(e){return nt(e.LABEL)&&e.LABEL!==""}var Cx="parent",Al="categories",Il="label",yl="group",Rl="push_mode",Sl="pop_mode",Ol="longer_alt",Nl="line_breaks",_l="start_chars_hint";function q(e){return vx(e)}function vx(e){let t=e.pattern,r={};if(r.name=e.name,ut(t)||(r.PATTERN=t),T(e,Cx))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return T(e,Al)&&(r.CATEGORIES=e[Al]),ee([r]),T(e,Il)&&(r.LABEL=e[Il]),T(e,yl)&&(r.GROUP=e[yl]),T(e,Sl)&&(r.POP_MODE=e[Sl]),T(e,Rl)&&(r.PUSH_MODE=e[Rl]),T(e,Ol)&&(r.LONGER_ALT=e[Ol]),T(e,Nl)&&(r.LINE_BREAKS=e[Nl]),T(e,_l)&&(r.START_CHARS_HINT=e[_l]),r}var kt=q({name:"EOF",pattern:et.NA});ee([kt]);function Le(e,t,r,n,i,o,s,a){return{image:t,startOffset:r,endOffset:n,startLine:i,endLine:o,startColumn:s,endColumn:a,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function Mi(e,t){return te(e,t)}var Fn={buildMismatchTokenMessage({expected:e,actual:t,previous:r,ruleName:n}){return`Expecting ${ki(e)?`--> ${be(e)} <--`:`token of type --> ${e.name} <--`} but found --> '${t.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:e,ruleName:t}){return"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage({expectedPathsPerAlt:e,actual:t,previous:r,customUserDescription:n,ruleName:i}){let o="Expecting: ",a=`
but found: '`+st(t).image+"'";if(n)return o+n+a;{let l=tt(e,(p,d)=>p.concat(d),[]),c=g(l,p=>`[${g(p,d=>be(d)).join(", ")}]`),u=`one of these possible Token sequences:
${g(c,(p,d)=>`  ${d+1}. ${p}`).join(`
`)}`;return o+u+a}},buildEarlyExitMessage({expectedIterationPaths:e,actual:t,customUserDescription:r,ruleName:n}){let i="Expecting: ",s=`
but found: '`+st(t).image+"'";if(r)return i+r+s;{let l=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${g(e,c=>`[${g(c,f=>be(f)).join(",")}]`).join(" ,")}>`;return i+l+s}}};Object.freeze(Fn);var Cl={buildRuleNotFoundError(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+`<-
inside top level rule: ->`+e.name+"<-"}},Mt={buildDuplicateFoundError(e,t){function r(f){return f instanceof C?f.terminalType.name:f instanceof w?f.nonTerminalName:""}let n=e.name,i=st(t),o=i.idx,s=Rt(i),a=r(i),l=o>0,c=`->${s}${l?o:""}<- ${a?`with argument: ->${a}<-`:""}
                  appears more than once (${t.length} times) in the top level rule: ->${n}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,`
`),c},buildNamespaceConflictError(e){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${e.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(e){let t=g(e.prefixPath,i=>be(i)).join(", "),r=e.alternation.idx===0?"":e.alternation.idx;return`Ambiguous alternatives: <${e.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${r}> inside <${e.topLevelRule.name}> Rule,
<${t}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(e){let t=g(e.prefixPath,i=>be(i)).join(", "),r=e.alternation.idx===0?"":e.alternation.idx,n=`Ambiguous Alternatives Detected: <${e.ambiguityIndices.join(" ,")}> in <OR${r}> inside <${e.topLevelRule.name}> Rule,
<${t}> may appears as a prefix path in all these alternatives.
`;return n=n+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,n},buildEmptyRepetitionError(e){let t=Rt(e.repetition);return e.repetition.idx!==0&&(t+=e.repetition.idx),`The repetition <${t}> within Rule <${e.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(e){return"deprecated"},buildEmptyAlternationError(e){return`Ambiguous empty alternative: <${e.emptyChoiceIdx+1}> in <OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(e){return`An Alternation cannot have more than 256 alternatives:
<OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.
 has ${e.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(e){let t=e.topLevelRule.name,r=g(e.leftRecursionPath,o=>o.name),n=`${t} --> ${r.concat([t]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${t}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${n}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(e){return"deprecated"},buildDuplicateRuleNameError(e){let t;return e.topLevelRule instanceof gt?t=e.topLevelRule.name:t=e.topLevelRule,`Duplicate definition, rule: ->${t}<- is already defined in the grammar: ->${e.grammarName}<-`}};function vl(e,t){let r=new wi(e,t);return r.resolveRefs(),r.errors}var wi=class extends xt{constructor(t,r){super(),this.nameToTopRule=t,this.errMsgProvider=r,this.errors=[]}resolveRefs(){x(L(this.nameToTopRule),t=>{this.currTopLevel=t,t.accept(this)})}visitNonTerminal(t){let r=this.nameToTopRule[t.nonTerminalName];if(r)t.referencedRule=r;else{let n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:n,type:it.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}}};var Fi=class extends Qt{constructor(t,r){super(),this.topProd=t,this.path=r,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=M(this.path.ruleStack).reverse(),this.occurrenceStack=M(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(t,r=[]){this.found||super.walk(t,r)}walkProdRef(t,r,n){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){let i=r.concat(n);this.updateExpectedNext(),this.walk(t.referencedRule,i)}}updateExpectedNext(){_(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}},Un=class extends Fi{constructor(t,r){super(t,r),this.path=r,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(t,r,n){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){let i=r.concat(n),o=new F({definition:i});this.possibleTokTypes=_e(o),this.found=!0}}},pr=class extends Qt{constructor(t,r){super(),this.topRule=t,this.occurrence=r,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}},Dn=class extends pr{walkMany(t,r,n){if(t.idx===this.occurrence){let i=st(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof C&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(t,r,n)}},wr=class extends pr{walkManySep(t,r,n){if(t.idx===this.occurrence){let i=st(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof C&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(t,r,n)}},Gn=class extends pr{walkAtLeastOne(t,r,n){if(t.idx===this.occurrence){let i=st(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof C&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(t,r,n)}},Fr=class extends pr{walkAtLeastOneSep(t,r,n){if(t.idx===this.occurrence){let i=st(r.concat(n));this.result.isEndOfRule=i===void 0,i instanceof C&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(t,r,n)}};function $n(e,t,r=[]){r=M(r);let n=[],i=0;function o(a){return a.concat(V(e,i+1))}function s(a){let l=$n(o(a),t,r);return n.concat(l)}for(;r.length<t&&i<e.length;){let a=e[i];if(a instanceof F)return s(a.definition);if(a instanceof w)return s(a.definition);if(a instanceof D)n=s(a.definition);else if(a instanceof Y){let l=a.definition.concat([new v({definition:a.definition})]);return s(l)}else if(a instanceof X){let l=[new F({definition:a.definition}),new v({definition:[new C({terminalType:a.separator})].concat(a.definition)})];return s(l)}else if(a instanceof K){let l=a.definition.concat([new v({definition:[new C({terminalType:a.separator})].concat(a.definition)})]);n=s(l)}else if(a instanceof v){let l=a.definition.concat([new v({definition:a.definition})]);n=s(l)}else{if(a instanceof H)return x(a.definition,l=>{_(l.definition)===!1&&(n=s(l.definition))}),n;if(a instanceof C)r.push(a.terminalType);else throw Error("non exhaustive match")}i++}return n.push({partialPath:r,suffixDef:V(e,i)}),n}function Bn(e,t,r,n){let i="EXIT_NONE_TERMINAL",o=[i],s="EXIT_ALTERNATIVE",a=!1,l=t.length,c=l-n-1,f=[],u=[];for(u.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!_(u);){let p=u.pop();if(p===s){a&&jt(u).idx<=c&&u.pop();continue}let d=p.def,I=p.idx,y=p.ruleStack,S=p.occurrenceStack;if(_(d))continue;let E=d[0];if(E===i){let m={idx:I,def:V(d),ruleStack:Zt(y),occurrenceStack:Zt(S)};u.push(m)}else if(E instanceof C)if(I<l-1){let m=I+1,h=t[m];if(r(h,E.terminalType)){let O={idx:m,def:V(d),ruleStack:y,occurrenceStack:S};u.push(O)}}else if(I===l-1)f.push({nextTokenType:E.terminalType,nextTokenOccurrence:E.idx,ruleStack:y,occurrenceStack:S}),a=!0;else throw Error("non exhaustive match");else if(E instanceof w){let m=M(y);m.push(E.nonTerminalName);let h=M(S);h.push(E.idx);let O={idx:I,def:E.definition.concat(o,V(d)),ruleStack:m,occurrenceStack:h};u.push(O)}else if(E instanceof D){let m={idx:I,def:V(d),ruleStack:y,occurrenceStack:S};u.push(m),u.push(s);let h={idx:I,def:E.definition.concat(V(d)),ruleStack:y,occurrenceStack:S};u.push(h)}else if(E instanceof Y){let m=new v({definition:E.definition,idx:E.idx}),h=E.definition.concat([m],V(d)),O={idx:I,def:h,ruleStack:y,occurrenceStack:S};u.push(O)}else if(E instanceof X){let m=new C({terminalType:E.separator}),h=new v({definition:[m].concat(E.definition),idx:E.idx}),O=E.definition.concat([h],V(d)),N={idx:I,def:O,ruleStack:y,occurrenceStack:S};u.push(N)}else if(E instanceof K){let m={idx:I,def:V(d),ruleStack:y,occurrenceStack:S};u.push(m),u.push(s);let h=new C({terminalType:E.separator}),O=new v({definition:[h].concat(E.definition),idx:E.idx}),N=E.definition.concat([O],V(d)),Tt={idx:I,def:N,ruleStack:y,occurrenceStack:S};u.push(Tt)}else if(E instanceof v){let m={idx:I,def:V(d),ruleStack:y,occurrenceStack:S};u.push(m),u.push(s);let h=new v({definition:E.definition,idx:E.idx}),O=E.definition.concat([h],V(d)),N={idx:I,def:O,ruleStack:y,occurrenceStack:S};u.push(N)}else if(E instanceof H)for(let m=E.definition.length-1;m>=0;m--){let h=E.definition[m],O={idx:I,def:h.definition.concat(V(d)),ruleStack:y,occurrenceStack:S};u.push(O),u.push(s)}else if(E instanceof F)u.push({idx:I,def:E.definition.concat(V(d)),ruleStack:y,occurrenceStack:S});else if(E instanceof gt)u.push(bx(E,I,y,S));else throw Error("non exhaustive match")}return f}function bx(e,t,r,n){let i=M(r);i.push(e.name);let o=M(n);return o.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:o}}var j;(function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"})(j||(j={}));function jn(e){if(e instanceof D||e==="Option")return j.OPTION;if(e instanceof v||e==="Repetition")return j.REPETITION;if(e instanceof Y||e==="RepetitionMandatory")return j.REPETITION_MANDATORY;if(e instanceof X||e==="RepetitionMandatoryWithSeparator")return j.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof K||e==="RepetitionWithSeparator")return j.REPETITION_WITH_SEPARATOR;if(e instanceof H||e==="Alternation")return j.ALTERNATION;throw Error("non exhaustive match")}function Ll(e,t,r,n,i,o){let s=Ur(e,t,r),a=Ul(s)?ur:te;return o(s,n,a,i)}function Pl(e,t,r,n,i,o){let s=Dr(e,t,i,r),a=Ul(s)?ur:te;return o(s[0],a,n)}function kl(e,t,r,n){let i=e.length,o=ct(e,s=>ct(s,a=>a.length===1));if(t)return function(s){let a=g(s,l=>l.GATE);for(let l=0;l<i;l++){let c=e[l],f=c.length,u=a[l];if(!(u!==void 0&&u.call(this)===!1))t:for(let p=0;p<f;p++){let d=c[p],I=d.length;for(let y=0;y<I;y++){let S=this.LA(y+1);if(r(S,d[y])===!1)continue t}return l}}};if(o&&!n){let s=g(e,l=>rt(l)),a=tt(s,(l,c,f)=>(x(c,u=>{T(l,u.tokenTypeIdx)||(l[u.tokenTypeIdx]=f),x(u.categoryMatches,p=>{T(l,p)||(l[p]=f)})}),l),{});return function(){let l=this.LA(1);return a[l.tokenTypeIdx]}}else return function(){for(let s=0;s<i;s++){let a=e[s],l=a.length;t:for(let c=0;c<l;c++){let f=a[c],u=f.length;for(let p=0;p<u;p++){let d=this.LA(p+1);if(r(d,f[p])===!1)continue t}return s}}}}function Ml(e,t,r){let n=ct(e,o=>o.length===1),i=e.length;if(n&&!r){let o=rt(e);if(o.length===1&&_(o[0].categoryMatches)){let a=o[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===a}}else{let s=tt(o,(a,l,c)=>(a[l.tokenTypeIdx]=!0,x(l.categoryMatches,f=>{a[f]=!0}),a),[]);return function(){let a=this.LA(1);return s[a.tokenTypeIdx]===!0}}}else return function(){t:for(let o=0;o<i;o++){let s=e[o],a=s.length;for(let l=0;l<a;l++){let c=this.LA(l+1);if(t(c,s[l])===!1)continue t}return!0}return!1}}var Di=class extends Qt{constructor(t,r,n){super(),this.topProd=t,this.targetOccurrence=r,this.targetProdType=n}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(t,r,n,i){return t.idx===this.targetOccurrence&&this.targetProdType===r?(this.restDef=n.concat(i),!0):!1}walkOption(t,r,n){this.checkIsTarget(t,j.OPTION,r,n)||super.walkOption(t,r,n)}walkAtLeastOne(t,r,n){this.checkIsTarget(t,j.REPETITION_MANDATORY,r,n)||super.walkOption(t,r,n)}walkAtLeastOneSep(t,r,n){this.checkIsTarget(t,j.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||super.walkOption(t,r,n)}walkMany(t,r,n){this.checkIsTarget(t,j.REPETITION,r,n)||super.walkOption(t,r,n)}walkManySep(t,r,n){this.checkIsTarget(t,j.REPETITION_WITH_SEPARATOR,r,n)||super.walkOption(t,r,n)}},Wn=class extends xt{constructor(t,r,n){super(),this.targetOccurrence=t,this.targetProdType=r,this.targetRef=n,this.result=[]}checkIsTarget(t,r){t.idx===this.targetOccurrence&&this.targetProdType===r&&(this.targetRef===void 0||t===this.targetRef)&&(this.result=t.definition)}visitOption(t){this.checkIsTarget(t,j.OPTION)}visitRepetition(t){this.checkIsTarget(t,j.REPETITION)}visitRepetitionMandatory(t){this.checkIsTarget(t,j.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(t){this.checkIsTarget(t,j.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(t){this.checkIsTarget(t,j.REPETITION_WITH_SEPARATOR)}visitAlternation(t){this.checkIsTarget(t,j.ALTERNATION)}};function bl(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=[];return t}function Ui(e){let t=[""];for(let r=0;r<e.length;r++){let n=e[r],i=[];for(let o=0;o<t.length;o++){let s=t[o];i.push(s+"_"+n.tokenTypeIdx);for(let a=0;a<n.categoryMatches.length;a++){let l="_"+n.categoryMatches[a];i.push(s+l)}}t=i}return t}function Lx(e,t,r){for(let n=0;n<e.length;n++){if(n===r)continue;let i=e[n];for(let o=0;o<t.length;o++){let s=t[o];if(i[s]===!0)return!1}}return!0}function wl(e,t){let r=g(e,s=>$n([s],1)),n=bl(r.length),i=g(r,s=>{let a={};return x(s,l=>{let c=Ui(l.partialPath);x(c,f=>{a[f]=!0})}),a}),o=r;for(let s=1;s<=t;s++){let a=o;o=bl(a.length);for(let l=0;l<a.length;l++){let c=a[l];for(let f=0;f<c.length;f++){let u=c[f].partialPath,p=c[f].suffixDef,d=Ui(u);if(Lx(i,d,l)||_(p)||u.length===t){let y=n[l];if(Kn(y,u)===!1){y.push(u);for(let S=0;S<d.length;S++){let E=d[S];i[l][E]=!0}}}else{let y=$n(p,s+1,u);o[l]=o[l].concat(y),x(y,S=>{let E=Ui(S.partialPath);x(E,m=>{i[l][m]=!0})})}}}}return n}function Ur(e,t,r,n){let i=new Wn(e,j.ALTERNATION,n);return t.accept(i),wl(i.result,r)}function Dr(e,t,r,n){let i=new Wn(e,r);t.accept(i);let o=i.result,a=new Di(t,e,r).startWalking(),l=new F({definition:o}),c=new F({definition:a});return wl([l,c],n)}function Kn(e,t){t:for(let r=0;r<e.length;r++){let n=e[r];if(n.length===t.length){for(let i=0;i<n.length;i++){let o=t[i],s=n[i];if((o===s||s.categoryMatchesMap[o.tokenTypeIdx]!==void 0)===!1)continue t}return!0}}return!1}function Fl(e,t){return e.length<t.length&&ct(e,(r,n)=>{let i=t[n];return r===i||i.categoryMatchesMap[r.tokenTypeIdx]})}function Ul(e){return ct(e,t=>ct(t,r=>ct(r,n=>_(n.categoryMatches))))}function Dl(e){let t=e.lookaheadStrategy.validate({rules:e.rules,tokenTypes:e.tokenTypes,grammarName:e.grammarName});return g(t,r=>Object.assign({type:it.CUSTOM_LOOKAHEAD_VALIDATION},r))}function Gl(e,t,r,n){let i=mt(e,l=>Px(l,r)),o=Dx(e,t,r),s=mt(e,l=>wx(l,r)),a=mt(e,l=>Mx(l,e,n,r));return i.concat(o,s,a)}function Px(e,t){let r=new Gi;e.accept(r);let n=r.allProductions,i=Ai(n,kx),o=yt(i,a=>a.length>1);return g(L(o),a=>{let l=st(a),c=t.buildDuplicateFoundError(e,a),f=Rt(l),u={message:c,type:it.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:f,occurrence:l.idx},p=$l(l);return p&&(u.parameter=p),u})}function kx(e){return`${Rt(e)}_#_${e.idx}_#_${$l(e)}`}function $l(e){return e instanceof C?e.terminalType.name:e instanceof w?e.nonTerminalName:""}var Gi=class extends xt{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(t){this.allProductions.push(t)}visitOption(t){this.allProductions.push(t)}visitRepetitionWithSeparator(t){this.allProductions.push(t)}visitRepetitionMandatory(t){this.allProductions.push(t)}visitRepetitionMandatoryWithSeparator(t){this.allProductions.push(t)}visitRepetition(t){this.allProductions.push(t)}visitAlternation(t){this.allProductions.push(t)}visitTerminal(t){this.allProductions.push(t)}};function Mx(e,t,r,n){let i=[];if(tt(t,(s,a)=>a.name===e.name?s+1:s,0)>1){let s=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});i.push({message:s,type:it.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}function Bl(e,t,r){let n=[],i;return G(t,e)||(i=`Invalid rule override, rule: ->${e}<- cannot be overridden in the grammar: ->${r}<-as it is not defined in any of the super grammars `,n.push({message:i,type:it.INVALID_RULE_OVERRIDE,ruleName:e})),n}function Bi(e,t,r,n=[]){let i=[],o=Hn(t.definition);if(_(o))return[];{let s=e.name;G(o,e)&&i.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:it.LEFT_RECURSION,ruleName:s});let l=Ee(o,n.concat([e])),c=mt(l,f=>{let u=M(n);return u.push(f),Bi(e,f,r,u)});return i.concat(c)}}function Hn(e){let t=[];if(_(e))return t;let r=st(e);if(r instanceof w)t.push(r.referencedRule);else if(r instanceof F||r instanceof D||r instanceof Y||r instanceof X||r instanceof K||r instanceof v)t=t.concat(Hn(r.definition));else if(r instanceof H)t=rt(g(r.definition,o=>Hn(o.definition)));else if(!(r instanceof C))throw Error("non exhaustive match");let n=Ne(r),i=e.length>1;if(n&&i){let o=V(e);return t.concat(Hn(o))}else return t}var Gr=class extends xt{constructor(){super(...arguments),this.alternations=[]}visitAlternation(t){this.alternations.push(t)}};function Wl(e,t){let r=new Gr;e.accept(r);let n=r.alternations;return mt(n,o=>{let s=Zt(o.definition);return mt(s,(a,l)=>{let c=Bn([a],[],te,1);return _(c)?[{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:o,emptyChoiceIdx:l}),type:it.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:o.idx,alternative:l+1}]:[]})})}function jl(e,t,r){let n=new Gr;e.accept(n);let i=n.alternations;return i=Te(i,s=>s.ignoreAmbiguities===!0),mt(i,s=>{let a=s.idx,l=s.maxLookahead||t,c=Ur(a,e,l,s),f=Fx(c,s,e,r),u=Ux(c,s,e,r);return f.concat(u)})}var $i=class extends xt{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(t){this.allProductions.push(t)}visitRepetitionMandatory(t){this.allProductions.push(t)}visitRepetitionMandatoryWithSeparator(t){this.allProductions.push(t)}visitRepetition(t){this.allProductions.push(t)}};function wx(e,t){let r=new Gr;e.accept(r);let n=r.alternations;return mt(n,o=>o.definition.length>255?[{message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:o}),type:it.TOO_MANY_ALTS,ruleName:e.name,occurrence:o.idx}]:[])}function Kl(e,t,r){let n=[];return x(e,i=>{let o=new $i;i.accept(o);let s=o.allProductions;x(s,a=>{let l=jn(a),c=a.maxLookahead||t,f=a.idx,p=Dr(f,i,l,c)[0];if(_(rt(p))){let d=r.buildEmptyRepetitionError({topLevelRule:i,repetition:a});n.push({message:d,type:it.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),n}function Fx(e,t,r,n){let i=[],o=tt(e,(a,l,c)=>(t.definition[c].ignoreAmbiguities===!0||x(l,f=>{let u=[c];x(e,(p,d)=>{c!==d&&Kn(p,f)&&t.definition[d].ignoreAmbiguities!==!0&&u.push(d)}),u.length>1&&!Kn(i,f)&&(i.push(f),a.push({alts:u,path:f}))}),a),[]);return g(o,a=>{let l=g(a.alts,f=>f+1);return{message:n.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:l,prefixPath:a.path}),type:it.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:a.alts}})}function Ux(e,t,r,n){let i=tt(e,(s,a,l)=>{let c=g(a,f=>({idx:l,path:f}));return s.concat(c)},[]);return Wt(mt(i,s=>{if(t.definition[s.idx].ignoreAmbiguities===!0)return[];let l=s.idx,c=s.path,f=ft(i,p=>t.definition[p.idx].ignoreAmbiguities!==!0&&p.idx<l&&Fl(p.path,c));return g(f,p=>{let d=[p.idx+1,l+1],I=t.idx===0?"":t.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:d,prefixPath:p.path}),type:it.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:I,alternatives:d}})}))}function Dx(e,t,r){let n=[],i=g(t,o=>o.name);return x(e,o=>{let s=o.name;if(G(i,s)){let a=r.buildNamespaceConflictError(o);n.push({message:a,type:it.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:s})}}),n}function Hl(e){let t=nr(e,{errMsgProvider:Cl}),r={};return x(e.rules,n=>{r[n.name]=n}),vl(r,t.errMsgProvider)}function zl(e){return e=nr(e,{errMsgProvider:Mt}),Gl(e.rules,e.tokenTypes,e.errMsgProvider,e.grammarName)}var Vl="MismatchedTokenException",Yl="NoViableAltException",Xl="EarlyExitException",ql="NotAllInputParsedException",Jl=[Vl,Yl,Xl,ql];Object.freeze(Jl);function Ie(e){return G(Jl,e.name)}var hr=class extends Error{constructor(t,r){super(t),this.token=r,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},Pe=class extends hr{constructor(t,r,n){super(t,r),this.previousToken=n,this.name=Vl}},$r=class extends hr{constructor(t,r,n){super(t,r),this.previousToken=n,this.name=Yl}},Br=class extends hr{constructor(t,r){super(t,r),this.name=ql}},Wr=class extends hr{constructor(t,r,n){super(t,r),this.previousToken=n,this.name=Xl}};var Wi={},Ki="InRuleRecoveryException",ji=class extends Error{constructor(t){super(t),this.name=Ki}},zn=class{initRecoverable(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=T(t,"recoveryEnabled")?t.recoveryEnabled:Et.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Gx)}getTokenToInsert(t){let r=Le(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return r.isInsertedInRecovery=!0,r}canTokenTypeBeInsertedInRecovery(t){return!0}canTokenTypeBeDeletedInRecovery(t){return!0}tryInRepetitionRecovery(t,r,n,i){let o=this.findReSyncTokenType(),s=this.exportLexerState(),a=[],l=!1,c=this.LA(1),f=this.LA(1),u=()=>{let p=this.LA(0),d=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:p,ruleName:this.getCurrRuleFullName()}),I=new Pe(d,c,this.LA(0));I.resyncedTokens=Zt(a),this.SAVE_ERROR(I)};for(;!l;)if(this.tokenMatcher(f,i)){u();return}else if(n.call(this)){u(),t.apply(this,r);return}else this.tokenMatcher(f,o)?l=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,a));this.importLexerState(s)}shouldInRepetitionRecoveryBeTried(t,r,n){return!(n===!1||this.tokenMatcher(this.LA(1),t)||this.isBackTracking()||this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,r)))}getFollowsForInRuleRecovery(t,r){let n=this.getCurrentGrammarPath(t,r);return this.getNextPossibleTokenTypes(n)}tryInRuleRecovery(t,r){if(this.canRecoverWithSingleTokenInsertion(t,r))return this.getTokenToInsert(t);if(this.canRecoverWithSingleTokenDeletion(t)){let n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new ji("sad sad panda")}canPerformInRuleRecovery(t,r){return this.canRecoverWithSingleTokenInsertion(t,r)||this.canRecoverWithSingleTokenDeletion(t)}canRecoverWithSingleTokenInsertion(t,r){if(!this.canTokenTypeBeInsertedInRecovery(t)||_(r))return!1;let n=this.LA(1);return Kt(r,o=>this.tokenMatcher(n,o))!==void 0}canRecoverWithSingleTokenDeletion(t){return this.canTokenTypeBeDeletedInRecovery(t)?this.tokenMatcher(this.LA(2),t):!1}isInCurrentRuleReSyncSet(t){let r=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(r);return G(n,t)}findReSyncTokenType(){let t=this.flattenFollowSet(),r=this.LA(1),n=2;for(;;){let i=Kt(t,o=>Mi(r,o));if(i!==void 0)return i;r=this.LA(n),n++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return Wi;let t=this.getLastExplicitRuleShortName(),r=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:r,inRule:this.shortRuleNameToFullName(n)}}buildFullFollowKeyStack(){let t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return g(t,(n,i)=>i===0?Wi:{ruleName:this.shortRuleNameToFullName(n),idxInCallingRule:r[i],inRule:this.shortRuleNameToFullName(t[i-1])})}flattenFollowSet(){let t=g(this.buildFullFollowKeyStack(),r=>this.getFollowSetFromFollowKey(r));return rt(t)}getFollowSetFromFollowKey(t){if(t===Wi)return[kt];let r=t.ruleName+t.idxInCallingRule+Cn+t.inRule;return this.resyncFollows[r]}addToResyncTokens(t,r){return this.tokenMatcher(t,kt)||r.push(t),r}reSyncTo(t){let r=[],n=this.LA(1);for(;this.tokenMatcher(n,t)===!1;)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,r);return Zt(r)}attemptInRepetitionRecovery(t,r,n,i,o,s,a){}getCurrentGrammarPath(t,r){let n=this.getHumanReadableRuleStack(),i=M(this.RULE_OCCURRENCE_STACK);return{ruleStack:n,occurrenceStack:i,lastTok:t,lastTokOccurrence:r}}getHumanReadableRuleStack(){return g(this.RULE_STACK,t=>this.shortRuleNameToFullName(t))}};function Gx(e,t,r,n,i,o,s){let a=this.getKeyForAutomaticLookahead(n,i),l=this.firstAfterRepMap[a];if(l===void 0){let p=this.getCurrRuleFullName(),d=this.getGAstProductions()[p];l=new o(d,i).startWalking(),this.firstAfterRepMap[a]=l}let c=l.token,f=l.occurrence,u=l.isEndOfRule;this.RULE_STACK.length===1&&u&&c===void 0&&(c=kt,f=1),!(c===void 0||f===void 0)&&this.shouldInRepetitionRecoveryBeTried(c,f,s)&&this.tryInRepetitionRecovery(e,t,r,c)}function Vn(e,t,r){return r|t|e}var ek=32-8;var jr=class{constructor(t){var r;this.maxLookahead=(r=_optionalChain([t, 'optionalAccess', _4 => _4.maxLookahead]))!==null&&r!==void 0?r:Et.maxLookahead}validate(t){let r=this.validateNoLeftRecursion(t.rules);if(_(r)){let n=this.validateEmptyOrAlternatives(t.rules),i=this.validateAmbiguousAlternationAlternatives(t.rules,this.maxLookahead),o=this.validateSomeNonEmptyLookaheadPath(t.rules,this.maxLookahead);return[...r,...n,...i,...o]}return r}validateNoLeftRecursion(t){return mt(t,r=>Bi(r,r,Mt))}validateEmptyOrAlternatives(t){return mt(t,r=>Wl(r,Mt))}validateAmbiguousAlternationAlternatives(t,r){return mt(t,n=>jl(n,r,Mt))}validateSomeNonEmptyLookaheadPath(t,r){return Kl(t,r,Mt)}buildLookaheadForAlternation(t){return Ll(t.prodOccurrence,t.rule,t.maxLookahead,t.hasPredicates,t.dynamicTokensEnabled,kl)}buildLookaheadForOptional(t){return Pl(t.prodOccurrence,t.rule,t.maxLookahead,t.dynamicTokensEnabled,jn(t.prodType),Ml)}};var Xn=class{initLooksAhead(t){this.dynamicTokensEnabled=T(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:Et.dynamicTokensEnabled,this.maxLookahead=T(t,"maxLookahead")?t.maxLookahead:Et.maxLookahead,this.lookaheadStrategy=T(t,"lookaheadStrategy")?t.lookaheadStrategy:new jr({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(t){x(t,r=>{this.TRACE_INIT(`${r.name} Rule Lookahead`,()=>{let{alternation:n,repetition:i,option:o,repetitionMandatory:s,repetitionMandatoryWithSeparator:a,repetitionWithSeparator:l}=$x(r);x(n,c=>{let f=c.idx===0?"":c.idx;this.TRACE_INIT(`${Rt(c)}${f}`,()=>{let u=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:c.idx,rule:r,maxLookahead:c.maxLookahead||this.maxLookahead,hasPredicates:c.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),p=Vn(this.fullRuleNameToShort[r.name],256,c.idx);this.setLaFuncCache(p,u)})}),x(i,c=>{this.computeLookaheadFunc(r,c.idx,768,"Repetition",c.maxLookahead,Rt(c))}),x(o,c=>{this.computeLookaheadFunc(r,c.idx,512,"Option",c.maxLookahead,Rt(c))}),x(s,c=>{this.computeLookaheadFunc(r,c.idx,1024,"RepetitionMandatory",c.maxLookahead,Rt(c))}),x(a,c=>{this.computeLookaheadFunc(r,c.idx,1536,"RepetitionMandatoryWithSeparator",c.maxLookahead,Rt(c))}),x(l,c=>{this.computeLookaheadFunc(r,c.idx,1280,"RepetitionWithSeparator",c.maxLookahead,Rt(c))})})})}computeLookaheadFunc(t,r,n,i,o,s){this.TRACE_INIT(`${s}${r===0?"":r}`,()=>{let a=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:r,rule:t,maxLookahead:o||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:i}),l=Vn(this.fullRuleNameToShort[t.name],n,r);this.setLaFuncCache(l,a)})}getKeyForAutomaticLookahead(t,r){let n=this.getLastExplicitRuleShortName();return Vn(n,t,r)}getLaFuncFromCache(t){return this.lookAheadFuncsCache.get(t)}setLaFuncCache(t,r){this.lookAheadFuncsCache.set(t,r)}},Hi=class extends xt{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(t){this.dslMethods.option.push(t)}visitRepetitionWithSeparator(t){this.dslMethods.repetitionWithSeparator.push(t)}visitRepetitionMandatory(t){this.dslMethods.repetitionMandatory.push(t)}visitRepetitionMandatoryWithSeparator(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)}visitRepetition(t){this.dslMethods.repetition.push(t)}visitAlternation(t){this.dslMethods.alternation.push(t)}},Yn=new Hi;function $x(e){Yn.reset(),e.accept(Yn);let t=Yn.dslMethods;return Yn.reset(),t}function Yi(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset)}function Xi(e,t){isNaN(e.startOffset)===!0?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function Zl(e,t,r){e.children[r]===void 0?e.children[r]=[t]:e.children[r].push(t)}function Ql(e,t,r){e.children[t]===void 0?e.children[t]=[r]:e.children[t].push(r)}var Bx="name";function qi(e,t){Object.defineProperty(e,Bx,{enumerable:!1,configurable:!0,writable:!1,value:t})}function Wx(e,t){let r=P(e),n=r.length;for(let i=0;i<n;i++){let o=r[i],s=e[o],a=s.length;for(let l=0;l<a;l++){let c=s[l];c.tokenTypeIdx===void 0&&this[c.name](c.children,t)}}}function tc(e,t){let r=function(){};qi(r,e+"BaseSemantics");let n={visit:function(i,o){if(A(i)&&(i=i[0]),!ut(i))return this[i.name](i.children,o)},validateVisitor:function(){let i=jx(this,t);if(!_(i)){let o=g(i,s=>s.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${o.join(`

`).replace(/\n/g,`
	`)}`)}}};return r.prototype=n,r.prototype.constructor=r,r._RULE_NAMES=t,r}function ec(e,t,r){let n=function(){};qi(n,e+"BaseSemanticsWithDefaults");let i=Object.create(r.prototype);return x(t,o=>{i[o]=Wx}),n.prototype=i,n.prototype.constructor=n,n}var Ji;(function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"})(Ji||(Ji={}));function jx(e,t){return Kx(e,t)}function Kx(e,t){let r=ft(t,i=>dt(e[i])===!1),n=g(r,i=>({msg:`Missing visitor method: <${i}> on ${e.constructor.name} CST Visitor.`,type:Ji.MISSING_METHOD,methodName:i}));return Wt(n)}var Qn=class{initTreeBuilder(t){if(this.CST_STACK=[],this.outputCst=t.outputCst,this.nodeLocationTracking=T(t,"nodeLocationTracking")?t.nodeLocationTracking:Et.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=W,this.cstFinallyStateUpdate=W,this.cstPostTerminal=W,this.cstPostNonTerminal=W,this.cstPostRule=W;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Xi,this.setNodeLocationFromNode=Xi,this.cstPostRule=W,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=W,this.setNodeLocationFromNode=W,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Yi,this.setNodeLocationFromNode=Yi,this.cstPostRule=W,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=W,this.setNodeLocationFromNode=W,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=W,this.setNodeLocationFromNode=W,this.cstPostRule=W,this.setInitialNodeLocation=W;else throw Error(`Invalid <nodeLocationTracking> config option: "${t.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(t){t.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(t){let r=this.LA(1);t.location={startOffset:r.startOffset,startLine:r.startLine,startColumn:r.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(t){let r={name:t,children:Object.create(null)};this.setInitialNodeLocation(r),this.CST_STACK.push(r)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(t){let r=this.LA(0),n=t.location;n.startOffset<=r.startOffset?(n.endOffset=r.endOffset,n.endLine=r.endLine,n.endColumn=r.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)}cstPostRuleOnlyOffset(t){let r=this.LA(0),n=t.location;n.startOffset<=r.startOffset?n.endOffset=r.endOffset:n.startOffset=NaN}cstPostTerminal(t,r){let n=this.CST_STACK[this.CST_STACK.length-1];Zl(n,r,t),this.setNodeLocationFromToken(n.location,r)}cstPostNonTerminal(t,r){let n=this.CST_STACK[this.CST_STACK.length-1];Ql(n,r,t),this.setNodeLocationFromNode(n.location,t.location)}getBaseCstVisitorConstructor(){if(ut(this.baseCstVisitorConstructor)){let t=tc(this.className,P(this.gastProductionsCache));return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(ut(this.baseCstVisitorWithDefaultsConstructor)){let t=ec(this.className,P(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){let t=this.RULE_STACK;return t[t.length-1]}getPreviousExplicitRuleShortName(){let t=this.RULE_STACK;return t[t.length-2]}getLastExplicitRuleOccurrenceIndex(){let t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]}};var ti=class{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(t){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):dr}LA(t){let r=this.currIdx+t;return r<0||this.tokVectorLength<=r?dr:this.tokVector[r]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(t){this.currIdx=t}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}};var ei=class{ACTION(t){return t.call(this)}consume(t,r,n){return this.consumeInternal(r,t,n)}subrule(t,r,n){return this.subruleInternal(r,t,n)}option(t,r){return this.optionInternal(r,t)}or(t,r){return this.orInternal(r,t)}many(t,r){return this.manyInternal(t,r)}atLeastOne(t,r){return this.atLeastOneInternal(t,r)}CONSUME(t,r){return this.consumeInternal(t,0,r)}CONSUME1(t,r){return this.consumeInternal(t,1,r)}CONSUME2(t,r){return this.consumeInternal(t,2,r)}CONSUME3(t,r){return this.consumeInternal(t,3,r)}CONSUME4(t,r){return this.consumeInternal(t,4,r)}CONSUME5(t,r){return this.consumeInternal(t,5,r)}CONSUME6(t,r){return this.consumeInternal(t,6,r)}CONSUME7(t,r){return this.consumeInternal(t,7,r)}CONSUME8(t,r){return this.consumeInternal(t,8,r)}CONSUME9(t,r){return this.consumeInternal(t,9,r)}SUBRULE(t,r){return this.subruleInternal(t,0,r)}SUBRULE1(t,r){return this.subruleInternal(t,1,r)}SUBRULE2(t,r){return this.subruleInternal(t,2,r)}SUBRULE3(t,r){return this.subruleInternal(t,3,r)}SUBRULE4(t,r){return this.subruleInternal(t,4,r)}SUBRULE5(t,r){return this.subruleInternal(t,5,r)}SUBRULE6(t,r){return this.subruleInternal(t,6,r)}SUBRULE7(t,r){return this.subruleInternal(t,7,r)}SUBRULE8(t,r){return this.subruleInternal(t,8,r)}SUBRULE9(t,r){return this.subruleInternal(t,9,r)}OPTION(t){return this.optionInternal(t,0)}OPTION1(t){return this.optionInternal(t,1)}OPTION2(t){return this.optionInternal(t,2)}OPTION3(t){return this.optionInternal(t,3)}OPTION4(t){return this.optionInternal(t,4)}OPTION5(t){return this.optionInternal(t,5)}OPTION6(t){return this.optionInternal(t,6)}OPTION7(t){return this.optionInternal(t,7)}OPTION8(t){return this.optionInternal(t,8)}OPTION9(t){return this.optionInternal(t,9)}OR(t){return this.orInternal(t,0)}OR1(t){return this.orInternal(t,1)}OR2(t){return this.orInternal(t,2)}OR3(t){return this.orInternal(t,3)}OR4(t){return this.orInternal(t,4)}OR5(t){return this.orInternal(t,5)}OR6(t){return this.orInternal(t,6)}OR7(t){return this.orInternal(t,7)}OR8(t){return this.orInternal(t,8)}OR9(t){return this.orInternal(t,9)}MANY(t){this.manyInternal(0,t)}MANY1(t){this.manyInternal(1,t)}MANY2(t){this.manyInternal(2,t)}MANY3(t){this.manyInternal(3,t)}MANY4(t){this.manyInternal(4,t)}MANY5(t){this.manyInternal(5,t)}MANY6(t){this.manyInternal(6,t)}MANY7(t){this.manyInternal(7,t)}MANY8(t){this.manyInternal(8,t)}MANY9(t){this.manyInternal(9,t)}MANY_SEP(t){this.manySepFirstInternal(0,t)}MANY_SEP1(t){this.manySepFirstInternal(1,t)}MANY_SEP2(t){this.manySepFirstInternal(2,t)}MANY_SEP3(t){this.manySepFirstInternal(3,t)}MANY_SEP4(t){this.manySepFirstInternal(4,t)}MANY_SEP5(t){this.manySepFirstInternal(5,t)}MANY_SEP6(t){this.manySepFirstInternal(6,t)}MANY_SEP7(t){this.manySepFirstInternal(7,t)}MANY_SEP8(t){this.manySepFirstInternal(8,t)}MANY_SEP9(t){this.manySepFirstInternal(9,t)}AT_LEAST_ONE(t){this.atLeastOneInternal(0,t)}AT_LEAST_ONE1(t){return this.atLeastOneInternal(1,t)}AT_LEAST_ONE2(t){this.atLeastOneInternal(2,t)}AT_LEAST_ONE3(t){this.atLeastOneInternal(3,t)}AT_LEAST_ONE4(t){this.atLeastOneInternal(4,t)}AT_LEAST_ONE5(t){this.atLeastOneInternal(5,t)}AT_LEAST_ONE6(t){this.atLeastOneInternal(6,t)}AT_LEAST_ONE7(t){this.atLeastOneInternal(7,t)}AT_LEAST_ONE8(t){this.atLeastOneInternal(8,t)}AT_LEAST_ONE9(t){this.atLeastOneInternal(9,t)}AT_LEAST_ONE_SEP(t){this.atLeastOneSepFirstInternal(0,t)}AT_LEAST_ONE_SEP1(t){this.atLeastOneSepFirstInternal(1,t)}AT_LEAST_ONE_SEP2(t){this.atLeastOneSepFirstInternal(2,t)}AT_LEAST_ONE_SEP3(t){this.atLeastOneSepFirstInternal(3,t)}AT_LEAST_ONE_SEP4(t){this.atLeastOneSepFirstInternal(4,t)}AT_LEAST_ONE_SEP5(t){this.atLeastOneSepFirstInternal(5,t)}AT_LEAST_ONE_SEP6(t){this.atLeastOneSepFirstInternal(6,t)}AT_LEAST_ONE_SEP7(t){this.atLeastOneSepFirstInternal(7,t)}AT_LEAST_ONE_SEP8(t){this.atLeastOneSepFirstInternal(8,t)}AT_LEAST_ONE_SEP9(t){this.atLeastOneSepFirstInternal(9,t)}RULE(t,r,n=mr){if(G(this.definedRulesNames,t)){let s={message:Mt.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),type:it.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(s)}this.definedRulesNames.push(t);let i=this.defineRule(t,r,n);return this[t]=i,i}OVERRIDE_RULE(t,r,n=mr){let i=Bl(t,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);let o=this.defineRule(t,r,n);return this[t]=o,o}BACKTRACK(t,r){return function(){this.isBackTrackingStack.push(1);let n=this.saveRecogState();try{return t.apply(this,r),!0}catch(i){if(Ie(i))return!1;throw i}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return _n(L(this.gastProductionsCache))}};var ri=class{initRecognizerEngine(t,r){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=ur,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},T(r,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(A(t)){if(_(t))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof t[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(A(t))this.tokensMap=tt(t,(o,s)=>(o[s.name]=s,o),{});else if(T(t,"modes")&&ct(rt(L(t.modes)),Tl)){let o=rt(L(t.modes)),s=ir(o);this.tokensMap=tt(s,(a,l)=>(a[l.name]=l,a),{})}else if(B(t))this.tokensMap=M(t);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=kt;let n=T(t,"modes")?rt(L(t.modes)):L(t),i=ct(n,o=>_(o.categoryMatches));this.tokenMatcher=i?ur:te,ee(L(this.tokensMap))}defineRule(t,r,n){if(this.selfAnalysisDone)throw Error(`Grammar rule <${t}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);let i=T(n,"resyncEnabled")?n.resyncEnabled:mr.resyncEnabled,o=T(n,"recoveryValueFunc")?n.recoveryValueFunc:mr.recoveryValueFunc,s=this.ruleShortNameIdx<<4+8;this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=t,this.fullRuleNameToShort[t]=s;let a;return this.outputCst===!0?a=function(...f){try{this.ruleInvocationStateUpdate(s,t,this.subruleIdx),r.apply(this,f);let u=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(u),u}catch(u){return this.invokeRuleCatch(u,i,o)}finally{this.ruleFinallyStateUpdate()}}:a=function(...f){try{return this.ruleInvocationStateUpdate(s,t,this.subruleIdx),r.apply(this,f)}catch(u){return this.invokeRuleCatch(u,i,o)}finally{this.ruleFinallyStateUpdate()}},Object.assign(a,{ruleName:t,originalGrammarAction:r})}invokeRuleCatch(t,r,n){let i=this.RULE_STACK.length===1,o=r&&!this.isBackTracking()&&this.recoveryEnabled;if(Ie(t)){let s=t;if(o){let a=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(a))if(s.resyncedTokens=this.reSyncTo(a),this.outputCst){let l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return n(t);else{if(this.outputCst){let l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,s.partialCstResult=l}throw s}}else{if(i)return this.moveToTerminatedState(),n(t);throw s}}else throw t}optionInternal(t,r){let n=this.getKeyForAutomaticLookahead(512,r);return this.optionInternalLogic(t,r,n)}optionInternalLogic(t,r,n){let i=this.getLaFuncFromCache(n),o;if(typeof t!="function"){o=t.DEF;let s=t.GATE;if(s!==void 0){let a=i;i=()=>s.call(this)&&a.call(this)}}else o=t;if(i.call(this)===!0)return o.call(this)}atLeastOneInternal(t,r){let n=this.getKeyForAutomaticLookahead(1024,t);return this.atLeastOneInternalLogic(t,r,n)}atLeastOneInternalLogic(t,r,n){let i=this.getLaFuncFromCache(n),o;if(typeof r!="function"){o=r.DEF;let s=r.GATE;if(s!==void 0){let a=i;i=()=>s.call(this)&&a.call(this)}}else o=r;if(i.call(this)===!0){let s=this.doSingleRepetition(o);for(;i.call(this)===!0&&s===!0;)s=this.doSingleRepetition(o)}else throw this.raiseEarlyExitException(t,j.REPETITION_MANDATORY,r.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,r],i,1024,t,Gn)}atLeastOneSepFirstInternal(t,r){let n=this.getKeyForAutomaticLookahead(1536,t);this.atLeastOneSepFirstInternalLogic(t,r,n)}atLeastOneSepFirstInternalLogic(t,r,n){let i=r.DEF,o=r.SEP;if(this.getLaFuncFromCache(n).call(this)===!0){i.call(this);let a=()=>this.tokenMatcher(this.LA(1),o);for(;this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,o,a,i,Fr],a,1536,t,Fr)}else throw this.raiseEarlyExitException(t,j.REPETITION_MANDATORY_WITH_SEPARATOR,r.ERR_MSG)}manyInternal(t,r){let n=this.getKeyForAutomaticLookahead(768,t);return this.manyInternalLogic(t,r,n)}manyInternalLogic(t,r,n){let i=this.getLaFuncFromCache(n),o;if(typeof r!="function"){o=r.DEF;let a=r.GATE;if(a!==void 0){let l=i;i=()=>a.call(this)&&l.call(this)}}else o=r;let s=!0;for(;i.call(this)===!0&&s===!0;)s=this.doSingleRepetition(o);this.attemptInRepetitionRecovery(this.manyInternal,[t,r],i,768,t,Dn,s)}manySepFirstInternal(t,r){let n=this.getKeyForAutomaticLookahead(1280,t);this.manySepFirstInternalLogic(t,r,n)}manySepFirstInternalLogic(t,r,n){let i=r.DEF,o=r.SEP;if(this.getLaFuncFromCache(n).call(this)===!0){i.call(this);let a=()=>this.tokenMatcher(this.LA(1),o);for(;this.tokenMatcher(this.LA(1),o)===!0;)this.CONSUME(o),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,o,a,i,wr],a,1280,t,wr)}}repetitionSepSecondInternal(t,r,n,i,o){for(;n();)this.CONSUME(r),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,r,n,i,o],n,1536,t,o)}doSingleRepetition(t){let r=this.getLexerPosition();return t.call(this),this.getLexerPosition()>r}orInternal(t,r){let n=this.getKeyForAutomaticLookahead(256,r),i=A(t)?t:t.DEF,s=this.getLaFuncFromCache(n).call(this,i);if(s!==void 0)return i[s].ALT.call(this);this.raiseNoAltException(r,t.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){let t=this.LA(1),r=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Br(r,t))}}subruleInternal(t,r,n){let i;try{let o=n!==void 0?n.ARGS:void 0;return this.subruleIdx=r,i=t.apply(this,o),this.cstPostNonTerminal(i,n!==void 0&&n.LABEL!==void 0?n.LABEL:t.ruleName),i}catch(o){throw this.subruleInternalError(o,n,t.ruleName)}}subruleInternalError(t,r,n){throw Ie(t)&&t.partialCstResult!==void 0&&(this.cstPostNonTerminal(t.partialCstResult,r!==void 0&&r.LABEL!==void 0?r.LABEL:n),delete t.partialCstResult),t}consumeInternal(t,r,n){let i;try{let o=this.LA(1);this.tokenMatcher(o,t)===!0?(this.consumeToken(),i=o):this.consumeInternalError(t,o,n)}catch(o){i=this.consumeInternalRecovery(t,r,o)}return this.cstPostTerminal(n!==void 0&&n.LABEL!==void 0?n.LABEL:t.name,i),i}consumeInternalError(t,r,n){let i,o=this.LA(0);throw n!==void 0&&n.ERR_MSG?i=n.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:r,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Pe(i,r,o))}consumeInternalRecovery(t,r,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){let i=this.getFollowsForInRuleRecovery(t,r);try{return this.tryInRuleRecovery(t,i)}catch(o){throw o.name===Ki?n:o}}else throw n}saveRecogState(){let t=this.errors,r=M(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:r,CST_STACK:this.CST_STACK}}reloadRecogState(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK}ruleInvocationStateUpdate(t,r,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(r)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){let t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]}shortRuleNameToFullName(t){return this.shortRuleNameToFull[t]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),kt)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}};var ni=class{initErrorHandler(t){this._errors=[],this.errorMessageProvider=T(t,"errorMessageProvider")?t.errorMessageProvider:Et.errorMessageProvider}SAVE_ERROR(t){if(Ie(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:M(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return M(this._errors)}set errors(t){this._errors=t}raiseEarlyExitException(t,r,n){let i=this.getCurrRuleFullName(),o=this.getGAstProductions()[i],a=Dr(t,o,r,this.maxLookahead)[0],l=[];for(let f=1;f<=this.maxLookahead;f++)l.push(this.LA(f));let c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:a,actual:l,previous:this.LA(0),customUserDescription:n,ruleName:i});throw this.SAVE_ERROR(new Wr(c,this.LA(1),this.LA(0)))}raiseNoAltException(t,r){let n=this.getCurrRuleFullName(),i=this.getGAstProductions()[n],o=Ur(t,i,this.maxLookahead),s=[];for(let c=1;c<=this.maxLookahead;c++)s.push(this.LA(c));let a=this.LA(0),l=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:s,previous:a,customUserDescription:r,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new $r(l,this.LA(1),a))}};var ii=class{initContentAssist(){}computeContentAssist(t,r){let n=this.gastProductionsCache[t];if(ut(n))throw Error(`Rule ->${t}<- does not exist in this grammar.`);return Bn([n],r,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(t){let r=st(t.ruleStack),i=this.getGAstProductions()[r];return new Un(i,t).startWalking()}};var ai={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(ai);var rc=!0,nc=Math.pow(2,8)-1,oc=q({name:"RECORDING_PHASE_TOKEN",pattern:et.NA});ee([oc]);var sc=Le(oc,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(sc);var zx={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}},oi=class{initGastRecorder(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let t=0;t<10;t++){let r=t>0?t:"";this[`CONSUME${r}`]=function(n,i){return this.consumeInternalRecord(n,t,i)},this[`SUBRULE${r}`]=function(n,i){return this.subruleInternalRecord(n,t,i)},this[`OPTION${r}`]=function(n){return this.optionInternalRecord(n,t)},this[`OR${r}`]=function(n){return this.orInternalRecord(n,t)},this[`MANY${r}`]=function(n){this.manyInternalRecord(t,n)},this[`MANY_SEP${r}`]=function(n){this.manySepFirstInternalRecord(t,n)},this[`AT_LEAST_ONE${r}`]=function(n){this.atLeastOneInternalRecord(t,n)},this[`AT_LEAST_ONE_SEP${r}`]=function(n){this.atLeastOneSepFirstInternalRecord(t,n)}}this.consume=function(t,r,n){return this.consumeInternalRecord(r,t,n)},this.subrule=function(t,r,n){return this.subruleInternalRecord(r,t,n)},this.option=function(t,r){return this.optionInternalRecord(r,t)},this.or=function(t,r){return this.orInternalRecord(r,t)},this.many=function(t,r){this.manyInternalRecord(t,r)},this.atLeastOne=function(t,r){this.atLeastOneInternalRecord(t,r)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{let t=this;for(let r=0;r<10;r++){let n=r>0?r:"";delete t[`CONSUME${n}`],delete t[`SUBRULE${n}`],delete t[`OPTION${n}`],delete t[`OR${n}`],delete t[`MANY${n}`],delete t[`MANY_SEP${n}`],delete t[`AT_LEAST_ONE${n}`],delete t[`AT_LEAST_ONE_SEP${n}`]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA})}ACTION_RECORD(t){}BACKTRACK_RECORD(t,r){return()=>!0}LA_RECORD(t){return dr}topLevelRuleRecord(t,r){try{let n=new gt({definition:[],name:t});return n.name=t,this.recordingProdStack.push(n),r.call(this),this.recordingProdStack.pop(),n}catch(n){if(n.KNOWN_RECORDER_ERROR!==!0)try{n.message=n.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch (e10){throw n}throw n}}optionInternalRecord(t,r){return Hr.call(this,D,t,r)}atLeastOneInternalRecord(t,r){Hr.call(this,Y,r,t)}atLeastOneSepFirstInternalRecord(t,r){Hr.call(this,X,r,t,rc)}manyInternalRecord(t,r){Hr.call(this,v,r,t)}manySepFirstInternalRecord(t,r){Hr.call(this,K,r,t,rc)}orInternalRecord(t,r){return Vx.call(this,t,r)}subruleInternalRecord(t,r,n){if(si(r),!t||T(t,"ruleName")===!1){let a=new Error(`<SUBRULE${ic(r)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(t)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}let i=jt(this.recordingProdStack),o=t.ruleName,s=new w({idx:r,nonTerminalName:o,label:_optionalChain([n, 'optionalAccess', _5 => _5.LABEL]),referencedRule:void 0});return i.definition.push(s),this.outputCst?zx:ai}consumeInternalRecord(t,r,n){if(si(r),!Li(t)){let s=new Error(`<CONSUME${ic(r)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(t)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw s.KNOWN_RECORDER_ERROR=!0,s}let i=jt(this.recordingProdStack),o=new C({idx:r,terminalType:t,label:_optionalChain([n, 'optionalAccess', _6 => _6.LABEL])});return i.definition.push(o),sc}};function Hr(e,t,r,n=!1){si(r);let i=jt(this.recordingProdStack),o=dt(t)?t:t.DEF,s=new e({definition:[],idx:r});return n&&(s.separator=t.SEP),T(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),o.call(this),i.definition.push(s),this.recordingProdStack.pop(),ai}function Vx(e,t){si(t);let r=jt(this.recordingProdStack),n=A(e)===!1,i=n===!1?e:e.DEF,o=new H({definition:[],idx:t,ignoreAmbiguities:n&&e.IGNORE_AMBIGUITIES===!0});T(e,"MAX_LOOKAHEAD")&&(o.maxLookahead=e.MAX_LOOKAHEAD);let s=Or(i,a=>dt(a.GATE));return o.hasPredicates=s,r.definition.push(o),x(i,a=>{let l=new F({definition:[]});o.definition.push(l),T(a,"IGNORE_AMBIGUITIES")?l.ignoreAmbiguities=a.IGNORE_AMBIGUITIES:T(a,"GATE")&&(l.ignoreAmbiguities=!0),this.recordingProdStack.push(l),a.ALT.call(this),this.recordingProdStack.pop()}),ai}function ic(e){return e===0?"":`${e}`}function si(e){if(e<0||e>nc){let t=new Error(`Invalid DSL Method idx value: <${e}>
	Idx value must be a none negative value smaller than ${nc+1}`);throw t.KNOWN_RECORDER_ERROR=!0,t}}var li=class{initPerformanceTracer(t){if(T(t,"traceInitPerf")){let r=t.traceInitPerf,n=typeof r=="number";this.traceInitMaxIdent=n?r:1/0,this.traceInitPerf=n?r>0:r}else this.traceInitMaxIdent=0,this.traceInitPerf=Et.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(t,r){if(this.traceInitPerf===!0){this.traceInitIndent++;let n=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${n}--> <${t}>`);let{time:i,value:o}=_r(r),s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(`${n}<-- <${t}> time: ${i}ms`),this.traceInitIndent--,o}else return r()}};function ac(e,t){t.forEach(r=>{let n=r.prototype;Object.getOwnPropertyNames(n).forEach(i=>{if(i==="constructor")return;let o=Object.getOwnPropertyDescriptor(n,i);o&&(o.get||o.set)?Object.defineProperty(e.prototype,i,o):e.prototype[i]=r.prototype[i]})})}var dr=Le(kt,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(dr);var Et=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Fn,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),mr=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0}),it;(function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",e[e.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(it||(it={}));var ke=class{static performSelfAnalysis(t){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let t;this.selfAnalysisDone=!0;let r=this.className;this.TRACE_INIT("toFastProps",()=>{Cr(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),x(this.definedRulesNames,i=>{let s=this[i].originalGrammarAction,a;this.TRACE_INIT(`${i} Rule`,()=>{a=this.topLevelRuleRecord(i,s)}),this.gastProductionsCache[i]=a})}finally{this.disableRecording()}});let n=[];if(this.TRACE_INIT("Grammar Resolving",()=>{n=Hl({rules:L(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(n)}),this.TRACE_INIT("Grammar Validations",()=>{if(_(n)&&this.skipValidations===!1){let i=zl({rules:L(this.gastProductionsCache),tokenTypes:L(this.tokensMap),errMsgProvider:Mt,grammarName:r}),o=Dl({lookaheadStrategy:this.lookaheadStrategy,rules:L(this.gastProductionsCache),tokenTypes:L(this.tokensMap),grammarName:r});this.definitionErrors=this.definitionErrors.concat(i,o)}}),_(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{let i=Qa(L(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,o;(o=(i=this.lookaheadStrategy).initialize)===null||o===void 0||o.call(i,{rules:L(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(L(this.gastProductionsCache))})),!ke.DEFER_DEFINITION_ERRORS_HANDLING&&!_(this.definitionErrors))throw t=g(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${t.join(`
-------------------------------
`)}`)})}constructor(t,r){this.definitionErrors=[],this.selfAnalysisDone=!1;let n=this;if(n.initErrorHandler(r),n.initLexerAdapter(),n.initLooksAhead(r),n.initRecognizerEngine(t,r),n.initRecoverable(r),n.initTreeBuilder(r),n.initContentAssist(),n.initGastRecorder(r),n.initPerformanceTracer(r),T(r,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=T(r,"skipValidations")?r.skipValidations:Et.skipValidations}};ke.DEFER_DEFINITION_ERRORS_HANDLING=!1;ac(ke,[zn,Xn,Qn,ti,ri,ei,ni,ii,oi,li]);var zr=class extends ke{constructor(t,r=Et){let n=M(r);n.outputCst=!0,super(t,n)}};function lc(e){let t={OR:"|",ELSE:"||",DYNAMIC:"$",STATIC:"#",ENTITY:"&",OPEN_GATE:"@",CLOSE_GATE:"@",PENDING_GATE:"@@",OPEN_SILENT:"{",CLOSE_SILENT:"}"};Object.assign(t,e?{OPEN_CHOICE:"(",CLOSE_CHOICE:")",OPEN_WEIGHT:"[",CLOSE_WEIGHT:"]",CONTINUATION:"\\"}:{OPEN_CHOICE:"[",CLOSE_CHOICE:"]",OPEN_WEIGHT:"^",CLOSE_WEIGHT:"^",CONTINUATION:"~"});let i={};Object.entries(t).forEach(([Er,ye])=>{i[Er]=Xx(ye)});let o=new RegExp(`${i.PENDING_GATE}([0-9]{9,11})`);i.SPECIAL=Object.values(i).join("").replace(/[<>]/g,""),t.PENDING_GATE_RE=new RegExp(o.source,"g");let s=q({name:"ExitGate",pattern:new RegExp(`\\s*${i.CLOSE_GATE}`),pop_mode:!0}),a=q({name:"Gate",pattern:new RegExp(`[^${i.CLOSE_GATE}]+`)}),l=q({name:"PendingGate",pattern:o}),c=q({name:"EnterGate",pattern:new RegExp(`${i.OPEN_GATE}\\s*`),push_mode:"gate_mode"}),f=q({name:"OC",pattern:new RegExp(i.OPEN_CHOICE+"\\s*")}),u=q({name:"CC",pattern:new RegExp(`\\s*${i.CLOSE_CHOICE}`)}),p=q({name:"OR",pattern:/\s*\|\s*/}),d=q({name:"ELSE",pattern:/\s*\|\|\s*/}),I=q({name:"EQ",pattern:/\s*=\s*/}),y=q({name:"TF",pattern:/\.[A-Za-z_0-9][A-Za-z_0-9]*(\(\))?/}),S=q({name:"OS",pattern:new RegExp(`${i.OPEN_SILENT}\\s*`)}),E=q({name:"CS",pattern:new RegExp(`\\s*${i.CLOSE_SILENT}`)}),m=q({name:"SYM",pattern:new RegExp(`[${i.DYNAMIC}${i.STATIC}][A-Za-z_0-9]*`)}),h=q({name:"Entity",pattern:/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/i}),O=q({name:"Weight",pattern:new RegExp(`\\s*${i.OPEN_WEIGHT}.+${i.CLOSE_WEIGHT}\\s*`)}),N=q({name:"Raw",pattern:new RegExp(`[^${i.SPECIAL}]+`)});return{tokens:{modes:{normal:[h,O,d,f,u,p,I,m,y,S,E,l,N,c],gate_mode:[a,s]},defaultMode:"normal"},Constants:{Symbols:t,Escaped:i}}}function Xx(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var ci=class extends zr{constructor(t){super(t,{nodeLocationTracking:"full"}),this.atomTypes=["silent","assign","symbol","choice","pgate","text","entity"],this.buildRules()}parse(t){this.input=t.tokens;let r=this.script();if(this.errors.length>0)throw Error(`[PARSING]
`+this.errors[0].message);return r}buildRules(){let t=this,r=this.tokensMap;t.RULE("script",()=>{t.MANY(()=>t.SUBRULE(t.expr))}),t.RULE("pgate",()=>{t.CONSUME(r.PendingGate),t.MANY(()=>t.CONSUME(r.TF))}),t.RULE("entity",()=>{t.CONSUME(r.Entity)}),t.RULE("gate",()=>{t.CONSUME(r.EnterGate),t.MANY(()=>t.CONSUME(r.Gate)),t.CONSUME(r.ExitGate)}),t.RULE("silent",()=>{t.CONSUME(r.OS),t.OPTION1(()=>t.SUBRULE(t.gate)),t.CONSUME(r.SYM),t.OPTION2(()=>{t.CONSUME(r.EQ),t.SUBRULE(t.expr)}),t.CONSUME(r.CS)}),t.RULE("assign",()=>{t.CONSUME(r.SYM),t.CONSUME(r.EQ),t.SUBRULE(t.expr)}),t.RULE("symbol",()=>{t.CONSUME(r.SYM),t.MANY(()=>t.CONSUME(r.TF))}),t.RULE("accept",()=>{t.SUBRULE(t.or_expr)}),t.RULE("reject",()=>{t.SUBRULE(t.or_expr)}),t.RULE("or_expr",()=>{t.MANY_SEP({SEP:r.OR,DEF:()=>t.SUBRULE(t.wexpr)})}),t.RULE("choice",()=>{t.CONSUME(r.OC),t.OPTION1(()=>t.SUBRULE(t.gate)),t.SUBRULE(t.accept),t.OPTION2(()=>{t.CONSUME(r.ELSE),t.SUBRULE(t.reject)}),t.CONSUME(r.CC),t.MANY(()=>t.CONSUME(r.TF))}),t.RULE("wexpr",()=>{t.MANY(()=>{t.OR([{ALT:()=>t.SUBRULE(t.expr)},{ALT:()=>t.CONSUME(r.Weight)}])})}),t.RULE("expr",()=>{t.AT_LEAST_ONE(()=>t.SUBRULE(t.atom))}),t.RULE("atom",()=>{t.OR(this.atomTypes.map(n=>({ALT:()=>t.SUBRULE(t[n])})))}),t.RULE("text",()=>{t.CONSUME(r.Raw)}),this.performSelfAnalysis()}};var Qi=class{constructor(t){this.input=0,this.path="",this.tracePath=!0,this.scripting=t,this.warnOnInvalidGates=!1,this.RiScript=this.scripting.constructor}isCstNode(t){return typeof t=="object"&&("accept"in t||"name"in t&&"location"in t&&"children"in t)}visit(t,r){if(Array.isArray(t)&&(t=t[0]),typeof t>"u")return;if(!this.isCstNode(t))throw Error("Non-cstNode passed to visit: "+JSON.stringify(t));let{name:n,location:i}=t;if(this.nodeText=this.input.substring(i.startOffset,i.endOffset+1),typeof this[n]!="function")throw Error(`BaseVisitor.visit: expecting function for this[${n}], found ${typeof this[n]}: ${JSON.stringify(this[n])}`);return this.tracePath&&!/(expr|atom|silent)/.test(n)&&(this.path+=n+"."),this[n](t.children,r)}validateVisitor(){}},gr=class extends Qi{constructor(t,r={}){super(t),this.context=r,this.trace=0,this.choices={},this.isNoRepeat=!1,this.symbols=this.scripting.Symbols,this.escaped=this.scripting.Escaped,this.statics={},this.dynamics={},this.pendingGates={},this.pendingSymbols=new Set,this.validateVisitor()}start(t={}){if(this.input=t.input,this.trace=t.trace,this.traceTx=t.traceTx,!t.cst)throw Error("no cst");return super.visit(t.cst)}script(t){this.order=0;let r=t.expr?t.expr.length:0;if(this.print("script","'"+this.RiScript._escapeText(this.input)+"' :: "+r+" expression(s)"),!r)return"";if(Object.keys(t).length!==1)throw Error("script: invalid expr");return this.visit(t.expr)}expr(t){let r=Object.keys(t);if(r.length!==1)throw Error("invalid expr: "+r.length);let n=t.atom.map(i=>this.visit(i));for(let i=1;i<n.length-1;i++)n[i].length===0&&n[i-1].endsWith(" ")&&n[i+1].startsWith(" ")&&(n[i+1]=n[i+1].substring(1));return n.join("")}wexpr(t){this.print("wexpr")}gate(t){if(t.Gate.length!==1)throw Error("Invalid gate: "+t.Gate);let r,n=t.Gate[0].image;try{r=this.scripting._query(n)}catch(l){if(!this.warnOnInvalidGates)throw Error(`Invalid gate[2]: "@${n}@"

RootCause -> ${l}`);return!this.scripting.RiTa.SILENT&&!this.scripting.silent&&console.warn(`[WARN] Ignoring invalid gate: @${n}@
`,l),{decision:"accept"}}let i={},o=[],s=r.operands();if(s.forEach(l=>{let{result:c,resolved:f,isStatic:u,isUser:p}=this.checkContext(l);typeof c=="function"&&(c=c.call(),f=!this.scripting.isParseable(c)),typeof c>"u"||!f?o.push(l):(u?this.statics[l]=c:p?this.context[l]=c:this.dynamics[l]=c,i[l]=c)}),Object.keys(i).length+o.length!==s.length)throw Error("invalid operands");if(o.length)return{decision:"defer",operands:o};let a=r.test(i);return!a&&this.castValues(i)&&(a=r.test(i)),{decision:a?"accept":"reject"}}assign(t,r){let n=t.SYM[0].image,i,o,s=n.replace(this.scripting.AnySymbolRE,"");if(n.startsWith(this.symbols.STATIC))i=this.visit(t.expr),this.scripting.isParseable(i)?(this.statics[s]=i,i=this.inlineAssignment(s,t.TF,i)):(this.statics[s]=i,this.pendingSymbols.delete(s),this.trace&&console.log("  [pending.delete]",n,this.pendingSymbols.length?JSON.stringify(this.pendingSymbols):"")),o=`${n} = ${this.RiScript._escapeText(i)} [#static] ${_optionalChain([r, 'optionalAccess', _7 => _7.silent])?"{silent}":""}`;else{let l=this;i=()=>l.visit(t.expr),o=`${n} = <f*:pending>`+(_optionalChain([r, 'optionalAccess', _8 => _8.silent])?"{silent}":""),this.dynamics[s]=i}return this.print("assign",o),i}silent(t){return t.EQ?this.assign(t,{silent:!0}):this.symbol(t,{silent:!0}),""}atom(t){let r,n=Object.keys(t);if(n.length!==1)throw Error("invalid atom: "+n);return this.scripting.parser.atomTypes.forEach(i=>{let o=t[i];if(o){if(o.length!==1)throw Error(i+": bad length -> "+t[i].length);r=this.visit(o[0])}}),typeof r=="function"&&(r=r.call()),r}text(t){if(t.Raw.length!==1)throw Error("[1] invalid text");if(Object.keys(t).length!==1)throw Error("[2] invalid text");let r=t.Raw[0].image;return this.print("text",this.RiScript._escapeText("'"+r+"'")),r}entity(t){return this.nodeText}symbol(t,r){if(t.SYM.length!==1)throw Error("[1] invalid symbol");let n=this.nodeText,i=t.SYM[0].image,o=i.replace(this.scripting.AnySymbolRE,"");if(this.isNoRepeat=this.hasNoRepeat(t.TF),this.pendingSymbols.has(o))return this.print("symbol",`${i} [is-pending]`),n;let{result:s,isStatic:a,isUser:l,resolved:c}=this.checkContext(o);if(!a&&i.startsWith(this.symbols.STATIC)&&!this.scripting.EntityRE.test(i))throw Error(`Attempt to refer to dynamic symbol '${o}' as ${this.symbols.STATIC}${o}, did you mean $${o}?`);if(typeof s=="function"&&(s=s.call(),c=!this.scripting.isParseable(s)),this.isNoRepeat&&(a||l)){this.isNoRepeat=!1;let u="Attempt to call norepeat() on "+(a?"static symbol '"+i+"'. Did you mean to use '"+this.symbols.DYNAMIC+o+"' ?":"non-dynamic symbol '"+o+"'. Did you mean to define '"+this.symbols.DYNAMIC+o+"' in riscript?");throw Error(u)}if(typeof s>"u")return this.print("symbol",i+" -> '"+n+"' ctx="+this.lookupsToString(),"[deferred]",_optionalChain([r, 'optionalAccess', _9 => _9.silent])?"{silent}":""),n;let f=n+" -> '"+s+"'"+(_optionalChain([r, 'optionalAccess', _10 => _10.silent])?" {silent}":"");return typeof s=="string"&&!c?(a?(this.pendingSymbols.add(o),s=this.inlineAssignment(o,t.TF,s),this.print("symbol*",`${n} -> ${s} :: pending.add(${o})`)):(t.TF&&(s=this.restoreTransforms(s,t.TF)),this.print("symbol",f)),s):(a&&(this.statics[o]=s),t.TF&&(s=this.applyTransforms(s,t.TF),f+=" -> '"+s+"'",this.isNoRepeat&&(f+=" (norepeat)")),this.print("symbol",f),this.pendingSymbols.has(o)&&(this.trace&&console.log("  [$pending.delete]",(a?"#":"$")+o,this.pendingSymbols.length?JSON.stringify(this.pendingSymbols):""),this.pendingSymbols.delete(o)),this.isNoRepeat=!1,s)}pgate(t){this.print("pgate",this.nodeText);let r=this.nodeText,n=r.replace(this.symbols.PENDING_GATE,""),i=this.pendingGates[n];if(!i)throw Error('no pending gate="'+r+'" pgates='+JSON.stringify(Object.keys(this.pendingGates)));return i.operands.some(a=>{let{result:l,resolved:c}=this.checkContext(a);return typeof l=="function"&&(l=l.call(),c=!this.scripting.isParseable(l)),typeof l>"u"||!c})?r:this.choice(i.deferredContext)}else(t){return this.visit(t.expr).trim()}choice(t,r){let n=this.symbols,i,o,s=this.nodeText,a=s,l=this.RiScript._stringHash(s+" #"+this.choiceId(t));if(!this.isNoRepeat&&this.hasNoRepeat(t.TF))throw Error("noRepeat() not allowed on choice (use a $variable instead): "+s);let c="accept";if(_optionalChain([r, 'optionalAccess', _11 => _11.forceReject]))c="reject";else if(t.gate&&(i=t.gate[0].children.Gate[0].image,o=this.visit(t.gate),c=o.decision,a+=`
  [gate] ${i} -> ${c!=="defer"?c.toUpperCase():`DEFER ${n.PENDING_GATE}${l}`}  ${this.lookupsToString()}`),o&&o.decision==="defer")return this.pendingGates[l]={deferredContext:t,operands:o.operands},`${n.PENDING_GATE}${l}`;if(c==="reject"&&!("reject"in t))return"";let f=_optionalChain([t, 'access', _12 => _12[c], 'optionalAccess', _13 => _13[0], 'optionalAccess', _14 => _14.children, 'optionalAccess', _15 => _15.or_expr, 'optionalAccess', _16 => _16[0]]),u=this.parseOptions(f);if(!u)throw Error("No options in choice: "+s);let p=null,d=[],I=!1;for(;p===null;){if(p=this.choose(u,d).value,this.scripting.isParseable(p)){t.TF&&(p=this.restoreTransforms(p,t.TF)),I=!0;break}if(t.TF&&(p=this.applyTransforms(p,t.TF)),this.isNoRepeat&&p===this.choices[l]){this.print("choice.reject",p+" [norepeat]"),d.push(p),p=null;continue}}return I||(this.choices[l]=p),p}hasNoRepeat(t){let r=this.RiScript._transformNames(t);return r.length?r.includes("nr")||r.includes("norepeat"):!1}checkContext(t){let r=!1,n=!1,i;if(t.length===0)return{result:"",resolved:!0,isStatic:r,isUser:n};i=this.dynamics[t],typeof i>"u"&&(i=this.statics[t],typeof i<"u"&&(r=!0)),typeof i>"u"&&(i=this.context[t],typeof i<"u"?n=!0:i=this.context[this.symbols.DYNAMIC+t]);let o=!this.scripting.isParseable(i);return{result:i,isStatic:r,isUser:n,resolved:o}}inlineAssignment(t,r,n){let i=this.symbols,o=i.STATIC+t,s=this.restoreTransforms(n,r);return n=i.OPEN_CHOICE+(o+"="+s)+i.CLOSE_CHOICE,n}choiceId(t){if(!t.OC||!t.OC.length)throw Error("invalid choice");return t.OC[0].startOffset+"."+t.OC[0].endOffset}parseOptions(t){let r=[];if(t&&_optionalChain([t, 'optionalAccess', _17 => _17.children, 'optionalAccess', _18 => _18.wexpr])){let n=t.children.wexpr;for(let i=0;i<n.length;i++){let o=n[i],s=o.children.expr;if(s&&s.length!=1)throw Error("invalid choice-expr: "+s.length);let a=o.children.Weight;if(a){if(a.length!=1)throw Error("invalid weight: "+a.length);let l=1;try{l=parseInt(this.symbols.CLOSE_WEIGHT.length?a[0].image.trim().slice(1,-1):a[0].image.trim().slice(1))}catch (e11){console.log("EX: "+l)}Array.from({length:l},()=>r.push(s))}else r.push(s||"")}}return r}chooseUnique(t,r){for(;t.length;){let{index:i,value:o}=this.choose(t);if(o!==this.choices[r])return o;t.splice(i,1)}throw Error("No remaining options")}choose(t,r=[]){if(!t||!t.length)throw Error("Invalid choice: no options");let n=t.filter(a=>!r.includes(a));if(!n.length)throw Error("Invalid choice: no valid options");let i=this.scripting.RiTa.randi(n.length),o="",s=n[i];return typeof s=="string"?this.print("choice.text","''"):(this.path="choice."+this.path,o=this.visit(s)),typeof o=="string"&&(o=o.trim()),{index:i,value:o}}applyTransforms(t,r){this.traceTx&&console.log("applyTransforms",this.formatTxs(...arguments));for(let n=0;n<r.length;n++)t=this.applyTransform(t,r[n]);return t}restoreTransforms(t,r){return typeof t=="string"&&(new RegExp("^"+this.escaped.OPEN_CHOICE+".*"+this.escaped.CLOSE_CHOICE+"$").test(t)||(t=this.symbols.OPEN_CHOICE+t+this.symbols.CLOSE_CHOICE),r&&r.forEach(i=>t+=i.image),this.traceTx&&console.log("restoreTransforms:",t)),t}castValues(t){let r=!1;return Object.entries(t).forEach(([n,i])=>{let o=parseFloat(i);isNaN(o)||(r=!0,t[n]=o)}),r}contextIsResolved(t){let r=!0;return Object.entries(t).forEach(([n,i])=>{this.scripting.isParseable(i)||(r=!1)}),r}applyTransform(t,r){let n=r.image,i,o=t+n,s=n.substring(1).replace(/\(\)$/,"");return typeof this.dynamics[s]=="function"?i=this.dynamics[s](t):typeof this.statics[s]=="function"?i=this.statics[s](t):typeof this.context[s]=="function"?i=this.context[s](t):typeof this.RiScript.transforms[s]=="function"?i=this.RiScript.transforms[s](t):typeof t[s]=="function"?i=t[s]():t.hasOwnProperty(s)?i=t[s]:(!this.scripting.RiTa.SILENT&&!this.scripting.silent&&console.warn("[WARN] Unresolved transform: "+o),i=o.replace(/\(\)$/,"&lpar;&rpar;")),this.trace&&console.log(`${this.tindent()}[transform] ${o} -> '${i}'`),i}lookupsToString(){let t={},r={};return Object.entries(this.dynamics||{}).forEach(([n,i])=>t[`$${n} `]=i),Object.entries(this.statics||{}).forEach(([n,i])=>r[`#${n} `]=i),JSON.stringify({...this.context,...r,...t},(n,i)=>typeof i=="function"?"<f*:pending>":i).replace(/"/g,"")}formatTxs(t,r){return t+r.map(n=>n.image.replace(/()/,"")+"()").join("")}print(t,...r){this.trace&&(this.path&&t!=="script"&&(t=this.path.replace(/\.$/,"")),console.log(++this.order,`[${t}]`,...r),this.path="")}tindent(){return" ".repeat((this.order+"").length+1)}};var{decode:Zx}=_he2.default,Qx=/[aeiou]/,xr="_RE_",tE=/&([a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});/gi,ui=class extends _mingo.Query{constructor(t,r,n){if(typeof r=="string"){let i=r;r=t.parseJSOL(r)}super(r,n)}test(t){for(let r=0,n=this.compiled.length;r<n;r++)if(!this.compiled[r](t))return!1;return!0}operands(){let t=[this.condition],r=new Set;for(;_optionalChain([t, 'optionalAccess', _19 => _19.length])>0;){let n=t.pop();Object.keys(n).forEach(i=>{let o=n[i];i.startsWith("$")||r.add(i),typeof o=="object"&&o!==null&&(Array.isArray(o)?o:[o]).forEach(a=>t.push(a))})}return Array.from(r)}},pt=class{static evaluate(t,r,n={}){return new pt().evaluate(t,r,n)}constructor(t={}){this.visitor=0,this.v2Compatible=t.compatibility===2;let{Constants:r,tokens:n}=lc(this.v2Compatible);this.Escaped=r.Escaped,this.Symbols=r.Symbols;let i=r.Escaped.STATIC+r.Escaped.DYNAMIC,o=r.Escaped.OPEN_CHOICE,s=r.Escaped.CLOSE_CHOICE;this.JSOLIdentRE=new RegExp(`([${i}]?[A-Za-z_0-9][A-Za-z_0-9]*)\\s*:`,"g"),this.RawAssignRE=new RegExp(`^[${i}][A-Za-z_0-9][A-Za-z_0-9]*\\s*=`),this.ChoiceWrapRE=new RegExp("^"+o+"[^"+o+s+"]*"+s+"$"),this.SpecialRE=new RegExp(`[${this.Escaped.SPECIAL.replace("&","")}]`),this.ContinueRE=new RegExp(this.Escaped.CONTINUATION+"\\r?\\n","g"),this.WhitespaceRE=/[\u00a0\u2000-\u200b\u2028-\u2029\u3000]+/g,this.AnySymbolRE=new RegExp(`[${i}]`),this.silent=!1,this.lexer=new et(n),this.parser=new ci(n),this.RiTa=t.RiTa||{VERSION:0,randi:a=>Math.floor(Math.random()*a)}}lex(t){if(!t.input)throw Error("no input");let r=this.lexer.tokenize(t.input);if(r.errors.length)throw console.error("Input: "+t.input+`
`,r.errors[0].message),Error("[LEXING] "+r.errors[0].message);t.trace&&this.printTokens(r.tokens),t.tokens=r.tokens}parse(t){t.cst=this.parser.parse(t)}visit(t){return this.visitor.start(t)}lexParseVisit(t={}){return this.lex(t),this.parse(t),this.visit(t)}evaluate(t,r,n={}){if(typeof t!="string")throw Error("RiScript.evaluate() expects a string, got "+typeof t);return n.input=t,n.visitor=new gr(this,r),this._evaluate(n)}_evaluate(t){let{input:r}=t,n,i=/\r?\n$/.test(r),o=this.preParse(r,t);if(!o)return"";if(t.trace&&console.log(`
Input:  '${pt._escapeText(r)}'`),t.trace&&r!==o&&console.log(`Parsed: '${pt._escapeText(o)}'`),!t.visitor)throw Error("no visitor");this.visitor=t.visitor,delete t.visitor;for(let s=1;o!==n&&s<=10&&(n=o,t.trace&&console.log("-".repeat(20)+" Pass#"+s+" "+"-".repeat(20)),t.input=o,o=this.lexParseVisit(t),t.trace&&console.log(`Result(${s}) -> "${pt._escapeText(o)}" ctx=${this.visitor.lookupsToString()}`),!(t.onepass||!this.isParseable(o)));s++);return!this.silent&&!this.RiTa.SILENT&&this.AnySymbolRE.test(o.replace(tE,""))&&console.warn('[WARN] Unresolved symbol(s) in "'+o.replace(/\n/g,"\\n")+'" '),this.postParse(o,t)+(i?`
`:"")}_query(t,r){return new ui(this,t,r)}printTokens(t){let r=t.reduce((n,i)=>{let{name:o}=i.tokenType,s=o;return s==="TEXT"&&(s=pt._escapeText(i.image,1)),s==="SYM"&&(s="sym("+i.image+")"),s==="TX"&&(s="tx("+i.image+")"),n+s+", "},"").slice(0,-2);console.log(`
Tokens: [ `+r+" ]  Context:",this.visitor.lookupsToString())}postParse(t,r){if(typeof t!="string")return"";let i=Zx(t).replace(this.WhitespaceRE," ").replace(/\r?\n$/,"");return[...i.matchAll(this.Symbols.PENDING_GATE_RE)].forEach(s=>{if(!s||!s[0]||!s[1])throw Error("bad gate: "+s);let a=this.visitor.pendingGates[s[1]],{deferredContext:l,operands:c}=a;if(!c.length)throw Error("no operands");let f=this.visitor.choice(l,{forceReject:!0});i=i.replace(s[0],f),r.trace&&console.log("  "+s[0]+"-> "+f)}),r.trace&&console.log(`
Final: '${i}'`),r.preserveLookups||(this.visitor.statics=void 0,this.visitor.dynamics=void 0),i}preParse(t,r){if(typeof t!="string")return"";let n=this.Symbols,i=t;this.v2Compatible||(i=i.replace(/\((\s*\d+\s*)\)/g,"^$1^")),i=i.replace(/\/\*[^]*?(\r?\n)?\//g,""),i=i.replace(/\/\/[^\n]+(\r?\n|$)/g,""),i=i.replace(this.ContinueRE,""),i=eE(i);let o="",s=i.split(/\r?\n/);for(let a=0;a<s.length;a++)if(this.RawAssignRE.test(s[a])){let l=s[a].indexOf("=");if(l<0)throw Error("invalid state: no assigment: "+s[a]);let c=s[a].substring(0,l),f=s[a].substring(l+1),u=fi(f,n.OPEN_CHOICE),p=fi(f,n.CLOSE_CHOICE);for(;u>p;){let d=s[++a];f+=`
`+d,u+=fi(d,n.OPEN_CHOICE),p+=fi(d,n.CLOSE_CHOICE)}o+=n.OPEN_SILENT+(c+"="+f)+n.CLOSE_SILENT}else o+=s[a],a<s.length-1&&(o+=`
`);return o}parseJSOL(t){let r=s=>{let a=s;if(typeof s=="string"&&s.startsWith(xr)&&s.endsWith(xr)){let l=s.split(xr);if(l.length!==4)throw Error("invalid regex in unescape");a=new RegExp(l[1],l[2])}return a},n=pt._escapeJSONRegex(t).replace(this.JSOLIdentRE,'"$1":').replace(/'/g,'"'),i=JSON.parse(n),o=r;return Object.keys(i).forEach(s=>i[s]=o(i[s])),i}isParseable(t){let r=!0;return/(string|number)/.test(typeof t)&&(r=this.SpecialRE.test(t.toString())),r}static articlize(t){if(!t||!t.length)return"";let r=t.split(/\s+/)[0];if(!_optionalChain([pt, 'access', _20 => _20.RiTa, 'optionalAccess', _21 => _21.phones]))return pt.RiTaWarnings.phones||(console.warn("[WARN] Install RiTa for proper phonemes"),pt.RiTaWarnings.phones=!0),(/^[aeiou].*/i.test(r)?"an ":"a ")+t;let n=pt.RiTa.phones(r,{silent:!0});return(n&&n.length&&Qx.test(n[0])?"an ":"a ")+t}static capitalize(t){return t?t[0].toUpperCase()+t.substring(1):""}static uppercase(t){return t?t.toUpperCase():""}static quotify(t){return"&#8220;"+(t||"")+"&#8221;"}static pluralize(t){return _optionalChain([pt, 'access', _22 => _22.RiTa, 'optionalAccess', _23 => _23.pluralize])?pt.RiTa.pluralize(t):(pt.RiTaWarnings.plurals||(pt.RiTaWarnings.plurals=!0,console.warn("[WARN] Install RiTa for proper pluralization")),t.endsWith("s")?t:t+"s")}static identity(t){return t}static _transformNames(t){return t&&t.length?t.map(r=>r.image.replace(/(^\.|\(\)$)/g,""),[]):[]}static _escapeText(t,r){if(typeof t!="string")return t;let n=t.replace(/\r?\n/g,"\\n");return r||!n.length?"'"+n+"'":n}static _escapeJSONRegex(t){return t.replace(/\/([^/]+?)\/([igmsuy]*)/g,`"${xr}$1${xr}$2${xr}"`)}static _stringHash(t){let r,n=0;for(let o=0;o<t.length;o++)r=t.charCodeAt(o),n=(n<<5)-n+r,n|=0;let i=n.toString();return n<0?i.replace("-","0"):i}},b=pt;qr(b,"Query",ui),qr(b,"VERSION","[VI]{version}[/VI]"),qr(b,"RiTaWarnings",{plurals:!1,phones:!1});b.transforms={quotify:b.quotify,pluralize:b.pluralize,capitalize:b.capitalize,articlize:b.articlize,uppercase:b.uppercase,norepeat:b.identity,art:b.articlize,nr:b.identity,cap:b.capitalize,ucf:b.capitalize,uc:b.uppercase,qq:b.quotify,s:b.pluralize};function eE(e){return e=zt(e,"\\(","&lpar;"),e=zt(e,"\\)","&rpar;"),e=zt(e,"\\[","&lsqb;"),e=zt(e,"\\]","&rsqb;"),e=zt(e,"\\{","&lcqb;"),e=zt(e,"\\}","&rcqb;"),e=zt(e,"\\@","&commat;"),e=zt(e,"\\#","&num;"),e=zt(e,"\\|"," &vert"),e=zt(e,"\\="," &equals"),e}function rE(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function zt(e,t,r){return e.replace(new RegExp(rE(t),"g"),()=>r)}function fi(e,t){let r=0;for(let n=0;n<e.length;n++)e[n]===t&&r++;return r}var Me=class{constructor(t={},r={}){if(typeof t!="object")throw Error("RiGrammar: expecting object, found "+typeof t);this.scripting=new b,this.context=r,this.setRules(t)}static expand(t,r,n){return new Me(t,r).expand(n)}addTransform(){return b.addTransform(...arguments)}removeTransform(){return b.removeTransform(...arguments)}getTransforms(){return b.transforms}equals(t){return t.toJSON()===this.toJSON()}expand(t={}){if("context"in t)throw Error("pass context to RiScript.grammar() or new RiGrammar() instead");return t.visitor=t.visitor||new b.Visitor(this.scripting),t.visitor.context=this.context||{},t.input=this._toScript(t),this.scripting._evaluate(t)}addRule(t,r){this._validateRule(t,r),this.rules[t]=r}setRules(t){if(typeof t>"u")throw Error("undefined rules");this.rules={};let r=typeof t=="string"?nE(t):t,n=this;Object.entries(r).forEach(i=>n.addRule(...i))}removeRule(t){t in this.rules&&delete this.rules[t]}toJSON(){return JSON.stringify(this.rules,...arguments)}toString(t={}){let r=t.replacer||0,n=t.space||2,i=_optionalChain([t, 'optionalAccess', _24 => _24.linebreak]),o=this.toJSON(r,n);return i&&(o=o.replace(/\n/g,i)),o}static fromJSON(t,r){return new Me(JSON.parse(t),r)}_toScript(t){let r="",n=t.start||"start",{Symbols:i}=this.scripting;if(n.startsWith(i.DYNAMIC)&&(n=n.substring(i.DYNAMIC.length)),n.startsWith(i.STATIC)&&(n=n.substring(i.STATIC.length)),!(n in this.rules||i.STATIC+n in this.rules))throw Error('Rule: "'+n+'" not found in grammar');return Object.entries(this.rules).forEach(([o,s],a)=>{for(;o.startsWith(i.DYNAMIC);)o=o.substring(1);o.startsWith(i.STATIC)||(o=i.DYNAMIC+o),this.scripting.ChoiceWrapRE.test(s)||(s=i.OPEN_CHOICE+s+i.CLOSE_CHOICE),r+=`${o}=${s}
`}),t.trace&&console.log(`Grammar:
`+r.replace(/^\$/gm,"  $")),r+=`${i.DYNAMIC}${n}`,r}_validateRule(t,r){if(typeof t!="string"||t.length===0)throw Error("expected [string] name");if(typeof r>"u")throw Error("undefined rule def: "+t);let{Symbols:n}=this.scripting;if(t.startsWith(n.DYNAMIC))throw t=t.substring(n.DYNAMIC.length),Error("Grammar rules are dynamic by default; if you need a static rule, use '"+n.STATIC+t+"', otherwise just use '"+t+"'.")}};function nE(e){if(typeof e=="string")try{return JSON.parse(e)}catch (e12){throw Error(`RiGrammar appears to be invalid JSON, please check it at http://jsonlint.com/
`+e)}}b.Grammar=Me;b.Visitor=gr;var Sw=b;exports.default = Sw;
/*! Bundled license information:

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
//# sourceMappingURL=riscript.cjs.map